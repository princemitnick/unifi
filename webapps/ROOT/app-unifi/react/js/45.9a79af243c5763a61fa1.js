(window.webpackJsonpunifiNetworkUi=window.webpackJsonpunifiNetworkUi||[]).push([[45],{1803:function(e,t,a){"use strict";a.r(t);var n,c=a(0),l=a.n(c),r=a(64),E=a(4),i=a(8),o=a(458),s=a(368),_=a(13),m=a(42),d=a(214),T=a(1945),u=a(21),S=a(18),N=a(2),A=a(45),O=a(222),b=a(173),C=a(2209),p=a(65),I=a(97),h=a(2113),g=a(75),M=a(1753),R=a(1754),L=a(1755),f=a(1850),D=a(5),j=a(23),v=a(159),U=a(2211),P=a(389),w=a.n(P),G=a(817),F=a.n(G),y=a(37),k="/api/s/{site}/cmd/productinfo",H=function(){return Object(N.n)(y.a.CHECK_FIRMWARE_UPDATE,k,{})},B=function(e){var t=e.username,a=e.password,n=e.token;return function(){var e=F()(w.a.mark((function e(c){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(Object(N.n)(y.a.REFRESH_SSO,"".concat(k,"/refresh-sso"),{sso_username:t,sso_password:a,sso_2fa_token:n}));case 2:return e.next=4,c(Object(m.fetchSettings)());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},x="".concat("/api/s/{site}/stat","/fwupdate/latest-version"),Y=function(){return Object(N.q)("stat/firmware",x)},W=a(16),$=a(22),V=a(1950);!function(e){e[e.GRID_TABLE=7]="GRID_TABLE"}(n||(n={}));var K=a(95),z=a(188),q=a(126),J=a(108),Q=a(33);const X=(e,t)=>e.replace(/\/network\/?/,t);var Z=a(230),ee=a.n(Z),te=a(31),ae=a(1972),ne=a(464),ce=a(2478),le=a.n(ce);var re=a(2168),Ee=a(2124),ie=a(1859),oe=a(660),se=a(170),_e=a(49),me=a(1924),de=a(1860),Te=a(831),ue=a(54),Se=a(52),Ne=a(2029),Ae=a(76);const Oe=Object(D.c)(Se.a)`
  width: 385px !important;
`,be=Object(D.c)(R.a,{shouldForwardProp:e=>"itemCount"!==e})`
  margin-top: ${({theme:e})=>e.spacing["spacing-l"]};
  height: ${({itemCount:e})=>Ne.a.getHeight(e,6)}px;

  table {
    background: none !important;

    tr {
      border-bottom: 1px solid ${({theme:e})=>e.motifPalette.ui04} !important;
    }
  }
`,Ce=Object(D.c)("div")`
  margin-bottom: ${({theme:e})=>e.spacing["spacing-xxl"]};
  text-align: center;
`,pe=Object(D.c)("footer",{shouldForwardProp:e=>"showBorder"!==e})`
  display: flex;
  align-items: center;
  justify-content: flex-end;
  margin-top: 32px;
  margin-bottom: 8px;

  ${({showBorder:e,theme:t})=>e&&`\n    border-top: 1px solid ${t.motifPalette.ui04};\n    padding-top: 32px;\n  `}
`,Ie=Object(D.c)(ie.a)`
  width: 100%;
  margin-top: ${({theme:e})=>e.spacing["spacing-m"]};

  > div {
    margin-right: 0 !important;
    > div {
      /* removed top margin for serach icon */
      margin-top: 0 !important;

      button {
        padding: 0 !important;
      }
    }
  }
`,he=Object(D.c)(K.g,{shouldForwardProp:e=>"width"!==e})`
  ${({width:e})=>e>0&&`\n    width: ${e}px;\n    max-width: ${e}px;\n    min-width: ${e}px;\n  `}
`,ge=Object(D.c)(oe.a,{shouldForwardProp:e=>"narrow"!==e})`
  > div:not(:first-child) {
    margin-left: ${({narrow:e,theme:t})=>t.spacing[e?"spacing-xxs":"spacing-s"]};
  }
`,Me=Object(D.c)(se.a,{shouldForwardProp:e=>"isActive"!==e})`
  width: 28px !important;
  height: 28px !important;
  margin-top: ${({theme:e})=>e.spacing["spacing-xs"]} !important;
  padding: 0 !important;
  ${({isActive:e,theme:t})=>!e&&`background: ${t.motifPalette.ui12} !important;`}
`,Re=Object(D.c)(L.a,{shouldForwardProp:e=>"prop"!==e})`
  flex: 2 1 ${({width:e})=>e}px;
`;var Le=Object(E.f)(({closeModal:e,intl:t})=>{const a=Object(i.useSelector)(b.selectDevicesBasicAdopted),n=Object(i.useSelector)(_.u),r=Object(i.useSelector)(_.L),{errors:o,handleSubmit:s,initialValues:m,isSubmitting:d,isValid:T,touched:u,values:S,setFieldValue:N,setTouched:O}=Object(A.e)(),{weekDays:C=[],repeat:p,repeatEveryCount:I,repeatEveryPeriod:h}=S,[g,f]=Object(c.useState)(!1),[D,v]=Object(c.useState)(""),U=!!(null==m?void 0:m._id),P=(u||U)&&(T||!Object.keys(null!=o?o:{}).filter(e=>"upgrade_targets"!==e).length),w=Object(c.useMemo)(()=>Object(re.b)(r),[r]),G=Object(c.useCallback)(()=>{S.name?f(!0):O({name:!0})},[f,O,S.name]),F=Object(c.useCallback)(()=>f(!1),[f]),y=Object(c.useCallback)(e=>N("upgrade_targets",e),[N]),k=Object(c.useCallback)(e=>{(null==C?void 0:C.includes(e))?N("weekDays",null==C?void 0:C.filter(t=>t!==e)):N("weekDays",[...C,e])},[C,N]),H=Object(c.useMemo)(()=>{const e=D.toLowerCase();return a.filter(({name:t,model:a,mac:n})=>[t,a,n,Object(Ae.a)({model:a})].some((t="")=>t.toLowerCase().indexOf(e)>=0))},[a,D]),B=Object(c.useMemo)(()=>{switch(p){case Ee.c.WEEKLY:return l.a.createElement(R.a,{disabled:n},l.a.createElement(L.a,{column:!0},l.a.createElement(_e.a,{size:"label",color:"tertiary"},l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_LABEL_REPEAT_ON_EVERY"})),l.a.createElement(ge,null,Te.a.map(({label:e,value:a})=>{const n=t.formatMessage({id:e})[0],c=null==C?void 0:C.includes(a);return l.a.createElement(Me,{isActive:c,variant:c?"primary":"default",onClick:()=>k(a),key:e},l.a.createElement(_e.a,{size:"caption"},n))})),!!o.weekDays&&l.a.createElement(ue.ValidationMessage,{visible:!0,translation:o.weekDays})));case Ee.c.MONTHLY:return l.a.createElement(R.a,{disabled:n},l.a.createElement(me.a,{alignWith:"dropdown",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_LABEL_REPEAT_ON_DAY_OF_MONTH"}),htmlFor:"dayInMonth"}),l.a.createElement(Re,{width:180,column:!0},l.a.createElement(ue.Field,{full:!0,max:"31",min:"1",name:"dayInMonth",type:"number"})));case Ee.c.ADVANCED:{const e=re.d.map(({label:e,value:a})=>({label:t.formatMessage({id:e},{count:I}),value:a})),a=Ee.a.YEAR!==h;return l.a.createElement(l.a.Fragment,null,l.a.createElement(R.a,{disabled:n},l.a.createElement(me.a,{alignWith:"dropdown",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_LABEL_REPEAT_EVERY"})}),l.a.createElement(Re,{width:180,column:!0},l.a.createElement(K.g,{justifyContent:a?"space-between":"flex-end",width:"180px"},a&&l.a.createElement(he,{width:56,flexDirection:"column"},l.a.createElement(ue.Field,{full:!0,min:"1",name:"repeatEveryCount",type:"number"})),l.a.createElement(he,{width:a?108:void 0},l.a.createElement(ue.Field,{full:!0,name:"repeatEveryPeriod",options:e,type:"dropdown"}))))),Ee.a.WEEK===h&&l.a.createElement(R.a,{disabled:n},l.a.createElement(me.a,{alignWith:"dropdown",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_LABEL_REPEAT_ON_EVERY"})}),l.a.createElement(Re,{width:208,column:!0},l.a.createElement(ge,{narrow:!0},Te.a.map(({label:e,value:a})=>{const n=t.formatMessage({id:e})[0],c=null==C?void 0:C.includes(a);return l.a.createElement(Me,{isActive:c,variant:c?"primary":"default",onClick:()=>k(a),key:e},l.a.createElement(_e.a,{size:"caption"},n))})),!!o.weekDays&&l.a.createElement(ue.ValidationMessage,{visible:!0,translation:o.weekDays}))),Ee.a.MONTH===h&&l.a.createElement(R.a,{disabled:n},l.a.createElement(me.a,{alignWith:"dropdown",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_LABEL_REPEAT_ON_DAY_OF_MONTH"}),htmlFor:"dayInMonth"}),l.a.createElement(Re,{width:180,column:!0},l.a.createElement(ue.Field,{full:!0,max:"31",min:"1",name:"dayInMonth",type:"number"}))))}default:return null}},[n,k,t,p,I,h,C,o.weekDays]);return l.a.createElement(Oe,{size:"small",isOpen:!0,header:()=>l.a.createElement(Ce,null,l.a.createElement(_e.a,{color:"primary",size:"header-s"},l.a.createElement(E.c,{id:U?"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_UPGRADE_EDIT_HEADER":"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_UPGRADE_NEW_HEADER",values:{name:null==m?void 0:m.name}}))),footer:l.a.createElement(pe,{showBorder:!g&&[Ee.c.WEEKLY,Ee.c.MONTHLY,Ee.c.ADVANCED].includes(p)},g?l.a.createElement(oe.a,null,l.a.createElement(se.a,{onClick:F,disabled:d},l.a.createElement(E.c,{id:"COMMON_ACTION_BACK"})),l.a.createElement(se.a,{onClick:()=>s(),variant:"primary",disabled:d||!T},l.a.createElement(E.c,{id:U?"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_LABEL_SAVE_SCHEDULE":"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_LABEL_CREATE_SCHEDULE"}))):l.a.createElement(oe.a,null,l.a.createElement(se.a,{onClick:e},l.a.createElement(E.c,{id:"COMMON_ACTION_CANCEL"})),l.a.createElement(se.a,{onClick:G,variant:"primary",disabled:!P},l.a.createElement(E.c,{id:"COMMON_ACTION_NEXT"})))),onRequestClose:e},g?l.a.createElement(M.a,{padding:"none"},l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_LABEL_TARGET_DEVICES_LABEL"}),l.a.createElement(Ie,{iconBefore:l.a.createElement(j.Hb,{size:"small"}),onChange:(e,t)=>v(t),onClear:e=>v(""),placeholder:"",value:D,full:!0}),l.a.createElement(be,{itemCount:a.length},l.a.createElement(de.a,{columns:re.f,items:H,idField:"mac",disableColumnFilters:!0,multiSelectMode:!0,disableSelection:n,initialSelectedIds:S.upgrade_targets,onChangeSelection:y}))):l.a.createElement(M.a,{padding:"none"},l.a.createElement(R.a,{disabled:n},l.a.createElement(L.a,{column:!0},l.a.createElement(ue.Field,{name:"name",full:!0,disabled:n,label:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_LABEL_NAME"}))),l.a.createElement(R.a,{disabled:n},l.a.createElement(L.a,{column:!0},l.a.createElement(ue.Field,{disabled:n,full:!0,label:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_LABEL_START_TIME",name:"startTime",options:w,translateLabel:!0,type:"dropdown"}))),l.a.createElement(R.a,{disabled:n},l.a.createElement(L.a,{column:!0},l.a.createElement(ue.Field,{disabled:n,full:!0,label:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_LABEL_REPEATS",name:"repeat",options:re.c,translateLabel:!0,translateOptions:!0,type:"dropdown"}))),B))}),fe=a(2213);var De=({closeModal:e})=>{const{formName:t,formId:a}=Object(te.m)(),n=Object(i.useDispatch)(),r=Object(i.useSelector)(C.selectScheduledUpgrades),E=t===re.e,o=Object(c.useMemo)(()=>E&&a&&r.find(({_id:e})=>e===a),[E,a,r]),s=Object(c.useMemo)(()=>{var e,t;return(null==o?void 0:o._id)?{...re.a,...o,...Object(fe.a)(o.cron_expr,o.execute_only_once),upgrade_targets:null!==(t=null===(e=o.upgrade_targets)||void 0===e?void 0:e.map(({mac:e})=>e))&&void 0!==t?t:[]}:re.a},[o]),_=Object(c.useCallback)((t,{setSubmitting:a})=>{var c;const{dayInMonth:l,weekDays:r,repeat:E,repeatEveryCount:i,repeatEveryPeriod:o,startTime:s,upgrade_targets:_,...m}=t,d={...m,upgrade_targets:null!==(c=null==_?void 0:_.map(e=>({mac:e})))&&void 0!==c?c:[],cron_expr:Object(fe.b)(t),execute_only_once:E===Ee.c.NEVER};n(Object(C.saveScheduledUpgrade)(d)).then(()=>{n(Object(u.c)({icon:S.a.success,message:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_SCHEDULED_UPGRADES_SAVE_SUCCESS"})),e()}).catch(e=>{n(Object(u.c)({errorMessage:e.msg,errorValues:e,icon:S.a.danger,message:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_SCHEDULED_UPGRADES_SAVE_ERROR"})),a(!1)})},[n,e]);return l.a.createElement(A.c,{enableReinitialize:!0,initialValues:s,validationSchema:re.g,onSubmit:_},l.a.createElement(Le,{closeModal:e}))};const je=Object(D.c)("div")`
  width: 100%;
`,ve=Object(D.c)("div")`
  margin-bottom: ${({theme:e})=>e.spacing["spacing-s"]};

  table {
    th {
      height: 30px !important;
      font-weight: 400 !important;
    }
  }
`,Ue=Object(D.c)(z.c)`
  border-radius: 0;
`,Pe=Object(D.c)("div")`
  margin-left: ${({theme:e})=>e.spacing["spacing-s"]};
  padding-top: ${({theme:e})=>e.spacing["spacing-xxs"]};
`;var we=()=>{const{formName:e}=Object(te.m)(),t=Object(te.k)(),a=Object(i.useDispatch)(),n=Object(i.useSelector)(C.selectScheduledUpgrades),o=Object(i.useSelector)(_.u),s=Object(i.useSelector)(b.selectAdoptedDevicesBasic),m=Object(i.useSelector)(_.L),d=e===re.e,T=Object(r.h)("system/maintenance"),S=`${T}/${re.e}`,N=Object(c.useCallback)((e=ee()())=>t.push(`${S}/${e}`),[S,t]),A=Object(c.useCallback)(()=>t.push(T),[t,T]),O=Object(c.useCallback)(({_id:e,name:t})=>{const{successToast:n,failureToast:c}=Object($.a)("SETTINGS_SYSTEM_MAINTENANCE_UPDATE_SCHEDULED_UPGRADES_REMOVE_ERROR","SETTINGS_SYSTEM_MAINTENANCE_UPDATE_SCHEDULED_UPGRADES_REMOVE_SUCCESS",{upgrade:t});a(Object(C.removeScheduledUpgrade)(e)).then(()=>a(Object(u.c)(n))).catch(e=>a(Object(u.c)(c(void 0,e))))},[a]),p=Object(c.useCallback)(e=>{a(Object(ne.b)({name:e.name,onConfirm:()=>O(e)}))},[a,O]),I=Object(c.useMemo)(()=>[{id:"name",renderLabel:()=>l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_SCHEDULED_UPGRADES_HEADER_NAME"}),minWidth:110},{id:"repeats",renderLabel:()=>l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_SCHEDULED_UPGRADES_HEADER_REPEATS"}),renderCell:({cron_expr:e,execute_only_once:t})=>{const{repeat:a,repeatEveryPeriod:n}=Object(fe.a)(e,t),c=a===Ee.c.ADVANCED?Ee.b[n]:a;return t?"-":l.a.createElement(E.c,{id:"COMMON_INTERVAL_"+c.toUpperCase()})},minWidth:80},{id:"nextUpdate",renderLabel:()=>l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_SCHEDULED_UPGRADES_HEADER_NEXT_UPDATE"}),renderCell:({cron_expr:e,execute_only_once:t})=>{const a=(e=>{var t;if(!e||e.split(" ").length<5)return null;try{const a=le.a.parseExpression(e),n=null===(t=null==a?void 0:a.next())||void 0===t?void 0:t.getTime();return n?new Date(n):null}catch(a){return null}})(e),{repeat:n,repeatEveryPeriod:c}=Object(fe.a)(e,t);let r=n===Ee.c.ADVANCED?Ee.b[c]:n;return r===Ee.c.NEVER&&(r=Ee.b.Hour),l.a.createElement(E.a,{value:a,format:r.toLowerCase(),hour12:!m})},minWidth:150}],[]);return s.length?l.a.createElement(l.a.Fragment,null,l.a.createElement(je,null,n.length>0&&l.a.createElement(ve,null,l.a.createElement(ae.a,{columns:I,disableColumnFilters:!0,disableSelection:!0,disableTextPointer:!0,items:n,idField:"_id",renderRowPopoverContent:e=>o?l.a.createElement(V.h,null,l.a.createElement(V.f,{onClick:()=>N(e._id),name:"view"},l.a.createElement(E.c,{id:"COMMON_ACTION_VIEW"}))):l.a.createElement(V.h,null,l.a.createElement(V.f,{onClick:()=>N(e._id),name:"upgrade"},l.a.createElement(E.c,{id:"COMMON_ACTION_EDIT"})),l.a.createElement(V.f,{onClick:()=>p(e),name:"remove"},l.a.createElement(E.c,{id:"COMMON_ACTION_REMOVE"}))),rowHeight:30,width:"100%"})),!o&&l.a.createElement(Ue,{name:"check-controller-package-update",type:"button",variant:"inline",onClick:()=>N(),legacy:!1},l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_SCHEDULED_UPGRADES_BUTTON_ADD"}))),!!d&&l.a.createElement(De,{closeModal:A})):l.a.createElement(K.g,null,l.a.createElement(j.cb,{isActive:!0}),l.a.createElement(Pe,null,l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_SCHEDULED_UPGRADES_NO_DEVCICES"})))},Ge=a(1799),Fe=a(2206),ye=a(20);var ke=a(78),He=a(1946);const Be=D.e`
    from: {
      opacity: 0;
    }
    50% {
      opacity: 1;
    }
    to {
      opacity: 0;
    }
`,xe=Object(D.c)(j.K)`
  opacity: 0;
  animation: ${Be} 2s ease-in-out 0s infinite;
`,Ye=[{compare:Object(He.a)(e=>Object(Ae.a)({model:e.device})),id:"deviceColumn",minWidth:150,label:l.a.createElement(E.c,{id:"SETTINGS_FIRMWARE_CACHE_HEADER_DEVICE"}),renderCell:e=>l.a.createElement(_e.a,{truncate:!0,color:"tertiary"},Object(Ae.a)({model:e.device})),sortable:!0},{id:"version",minWidth:110,label:l.a.createElement(E.c,{id:"SETTINGS_FIRMWARE_CACHE_HEADER_VERSION"}),renderCell:({version:e})=>l.a.createElement(_e.a,{truncate:!0,color:"tertiary"},e),sortable:!0},{id:"sizeColumn",minWidth:60,label:l.a.createElement(E.c,{id:"SETTINGS_FIRMWARE_CACHE_HEADER_SIZE"}),renderCell:e=>l.a.createElement("span",null,Object(ke.c)(e.size)||"-")},{id:"cachedColumn",minWidth:60,label:l.a.createElement(E.c,{id:"SETTINGS_FIRMWARE_CACHE_HEADER_CACHED"}),renderCell:e=>{let t="-";return e.isDownloading?t=l.a.createElement(xe,null):e.cached&&(t=l.a.createElement(j.w,null)),l.a.createElement("span",null,t)}}],We=Object(D.c)("div")`
  width: 100%;
  margin-bottom: ${({theme:e})=>e.spacing["spacing-s"]};

  table {
    th {
      font-weight: 400 !important;
    }
  }
`,$e=Object(D.c)("div")`
  margin-left: ${({theme:e})=>e.spacing["spacing-s"]};
  padding-top: ${({theme:e})=>e.spacing["spacing-xxs"]};
`,Ve=Object(D.c)(oe.a)`
  margin-bottom: ${({theme:e})=>e.spacing["spacing-l"]};
`,Ke=Object(D.c)(se.a,{shouldForwardProp:e=>"isActive"!==e})`
  height: 24px !important;
  background: ${({theme:e,isActive:t})=>t?e.motifPalette.ui12:"none"};
  ${({theme:e,isActive:t})=>t&&"color: "+e.motifPalette.text01};

  &:hover {
    background: ${({theme:e})=>e.motifPalette.hoverUi01};
  }
`;var ze=()=>{const[e,t]=Object(c.useState)({}),[a,n]=Object(c.useState)("all"),o=Object(i.useDispatch)(),s=Object(i.useSelector)(U.selectSiteFirmwares),_=Object(i.useSelector)(U.selectCachedSiteFirmwares),m=Object(c.useCallback)(({base_model:e,device:a,version:n})=>{t({base_model:e,version:n}),o(Object(U.downloadFirmwareAndRefresh)(a,n)).then(()=>t({}))},[o]),d=Object(c.useCallback)(e=>{o((({device:e,version:t})=>a=>{a(Object(ne.a)({title:"SETTINGS_FIRMWARE_DELETE_MODAL_TITLE",message:"SETTINGS_FIRMWARE_DELETE_MODAL_MESSAGE",messageValues:{deviceModel:Object(Ae.a)({model:e})},onConfirm:()=>{a(Object(U.removeFirmwareAndRefresh)(e,t)),a(Object(ye.e)())}}))})(e))},[o]),T=Object(c.useMemo)(()=>Object(Ge.a)("all"===a?s.map(t=>({...t,isDownloading:e.base_model===t.base_model&&e.version===t.version,isCacheDisabled:!!e.base_model})):_,"device"),[a,s,e,_]),u=Object(c.useCallback)(e=>{e.preventDefault(),n("all")},[n]),S=Object(c.useCallback)(e=>{e.preventDefault(),n("cached")},[n]);return Object(r.e)([Object(U.fetchAvailableFirmware)({type:N.a.CACHE}),Object(U.fetchCachedFirmware)({type:N.a.CACHE})],l.a.createElement(We,null,l.a.createElement(Ve,{variant:"cozy"},l.a.createElement(Ke,{pill:!0,onClick:u,isActive:"all"===a},l.a.createElement(E.c,{id:"SETTINGS_FIRMWARE_FILTER_AVAILABLE_FIRMWARE"})),l.a.createElement(Ke,{pill:!0,onClick:S,isActive:"cached"===a},l.a.createElement(E.c,{id:"SETTINGS_FIRMWARE_FILTER_CACHED_FIRMWARE"}))),T.length?l.a.createElement(Fe.a,{columns:Ye,disableColumnFilters:!0,disableSelection:!0,disableTextPointer:!0,idField:"device",items:T,renderRowPopoverContent:e=>l.a.createElement(V.h,null,e.cached?l.a.createElement(V.f,{text:"SETTINGS_FIRMWARE_CACHE_ACTION_DELETE",disabled:e.isDownloading,onClick:()=>d(e),name:"delete-cache"},l.a.createElement(E.c,{id:"SETTINGS_FIRMWARE_CACHE_ACTION_DELETE"})):l.a.createElement(V.f,{disabled:e.isCacheDisabled,onClick:()=>m(e),name:"cache"},l.a.createElement(E.c,{id:"SETTINGS_FIRMWARE_CACHE_ACTION_CACHE"}))),rowHeight:30,maxRows:6,headerHeight:32}):l.a.createElement(K.g,null,l.a.createElement("div",null,l.a.createElement(j.cb,{isActive:!0})),l.a.createElement($e,null,l.a.createElement(E.c,{id:"all"===a?"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_HEADER_FIRMWARE_ALL_EMPTY":"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_HEADER_FIRMWARE_CACHE_EMPTY"})))))},qe=a(39),Je=a(2910),Qe=a(380),Xe=a(145),Ze=a(1146),et=a(6);const tt=Object(D.c)(Se.a,{shouldForwardProp:e=>"extraSmall"!==e})`
  ${({extraSmall:e})=>e?"width: 340px;":""}
`,at=Object(D.c)("header")`
  margin-bottom: ${({theme:e})=>e.spacing["spacing-xxl"]};
  text-align: center;
`,nt=Object(D.c)("footer")`
  display: flex;
  align-items: center;
  justify-content: flex-end;
  margin-top: 24px;
`,ct=Object(D.c)(_e.a)`
  line-height: 1.6em;
`,lt=Object(D.c)(Ze.a)`
  margin-top: ${({theme:e})=>e.spacing["spacing-xl"]};
`,rt=Object(D.c)(j.cb)`
  margin-right: ${({theme:e})=>e.spacing["spacing-s"]};
  color: ${({theme:e})=>e.motifPalette.warning} !important;
`,Et=Object(D.c)(K.g)`
  margin-top: ${({theme:e})=>e.spacing["spacing-m"]};
`;var it,ot=({backupInfo:e,closeModal:t,onRestore:a})=>{var n;const r=Object(c.useMemo)(()=>(null==e?void 0:e.sites.length)>1,[]),o=Object(c.useMemo)(()=>null==e?void 0:e.sites.map(({_id:e,name:t})=>({label:t,value:e})),[]),[s,_]=Object(c.useState)(r?"":null===(n=o[0])||void 0===n?void 0:n.value),m=Object(i.useSelector)(I.k),d=Object(i.useSelector)(et.selectSiteGateway),T=Object(c.useCallback)(({value:e})=>{_(e)},[_]),u=Object(c.useMemo)(()=>r?m?"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_RESTORE_BACKUP_MULTI_SITES_DETECTED":"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_RESTORE_BACKUP_RESTORE_SITES":"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_RESTORE_BACKUP_RESTORE_SITE",[m,r]),S=Object(c.useMemo)(()=>r?m?l.a.createElement(l.a.Fragment,null,l.a.createElement(ct,null,l.a.createElement(E.b,{id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_RESTORE_BACKUP_SELECT_SITE_DESCRIPTION",values:{name:Object(Ae.b)(d)}})),l.a.createElement(lt,{label:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_RESTORE_BACKUP_SELECT_SITE",onChange:T,options:o,value:s}),l.a.createElement(Et,{alignItems:"center"},l.a.createElement(rt,{width:"12px",height:"12px"}),l.a.createElement(_e.a,{size:"label",color:"tertiary"},l.a.createElement(E.c,{id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_RESTORE_BACKUP_RESTART_INFO"})))):l.a.createElement(ct,null,l.a.createElement(E.b,{id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_RESTORE_BACKUP_MULTIPLE_SITES"})):l.a.createElement(ct,null,l.a.createElement(E.b,{id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_RESTORE_BACKUP_SINGLE_SITE",values:{site:o[0].label}})),[r,m,d,T,o,s]);return l.a.createElement(tt,{size:"small",extraSmall:!m||!r,isOpen:!0,header:()=>l.a.createElement(at,null,l.a.createElement(_e.a,{size:"header-s",weight:"bold"},l.a.createElement(E.c,{id:u}))),footer:()=>l.a.createElement(nt,null,l.a.createElement(oe.a,null,l.a.createElement(se.a,{onClick:t},l.a.createElement(E.c,{id:"COMMON_ACTION_CANCEL"})),l.a.createElement(se.a,{onClick:()=>a(s||void 0),variant:"primary",disabled:m&&r&&!s},l.a.createElement(E.c,{id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_RESTORE_BACKUP_RESTART"})))),onRequestClose:t},S)},st=a(358);!function(e){e.FINISHED="finished",e.IDLE="idle",e.RESTARTING="restarting",e.RESTORE="restore",e.SITE_CONFIRM="site-confirm"}(it||(it={}));const _t={update:Qe.a,remove:Qe.a};var mt=Object(qe.compose)(E.f,Xe.b)(({createNotification:e,removeNotification:t,intl:a})=>{const n=Object(i.useDispatch)(),r=Object(c.useRef)(null),[o,s]=Object(c.useState)(null),[m,d]=Object(c.useState)(it.IDLE),T=Object(c.useCallback)(()=>{r.current&&(r.current.value="")},[]),A=Object(c.useCallback)(()=>{n(Object(O.c)(o.backup_id)),s(null),d(it.IDLE)},[n,O.c,o,s,d]),b=Object(c.useCallback)(e=>{d(it.RESTORE),n(Object(O.i)({backup_id:o.backup_id,site_id:e})).then(()=>(n(Object(u.c)({type:S.a.info,id:"restarting-after-backup",message:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_RESTORE_BACKUP_RESTARTING",duration:0},"restarting-after-backup")),d(it.RESTARTING),n(Object(st.g)()))).then(()=>{n(Object(N.d)(_.a)),d(it.FINISHED),n(Object(u.d)("restarting-after-backup")),n(Object(u.c)({type:S.a.success,message:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_RESTORE_BACKUP_RESTORED",values:{count:(null==o?void 0:o.sites.length)||0}})),n(Object(_.g)()).then(()=>window.location.reload())}).catch(e=>{s(null),d(it.IDLE),n(Object(u.c)({errorMessage:e.msg,errorValues:e,icon:S.a.danger,message:"SETTINGS_CONTROLLER_MAINTENANCE_BACKUP_RESTORE_ERROR"}))})},[n,u.c,o,s,d]),C=Object(c.useCallback)((c,i)=>{var o;"current"in i&&(r.current=i.current);const _=null===(o=r.current)||void 0===o?void 0:o.files[0],m=null==_?void 0:_.name,N=e(l.a.createElement(Je.a,{id:"upload-restore-backup-file",renderTitle:e=>l.a.createElement(E.c,{id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_RESTORE_BACKUP_UPLOADING_FILES",values:{count:e}}),downloads:[{id:"upload-backup-file",files:[{filename:m,progress:void 0,status:a.formatMessage({id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_RESTORE_BACKUP_UPLOADING"})}],onCancel:()=>{t("upload-restore-backup-file"),A()}}],duration:0}))||_t;n(Object(O.k)(_)).then(e=>{N.update({downloads:[{id:"upload-backup-file",files:[{filename:m,progress:100,status:a.formatMessage({id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_RESTORE_BACKUP_UPLOADED"})}]}],duration:2e3});const t=Object(W.a)(e,"data[0]");s(t),d(it.SITE_CONFIRM)}).catch(e=>{T(),N.remove(),n(Object(u.c)({errorMessage:e.msg,errorValues:{...e,filename:m},icon:S.a.danger,message:"SETTINGS_CONTROLLER_MAINTENANCE_BACKUP_RESTORE_UPLOAD_ERROR"}))})},[n,u.c,s,T]);return l.a.createElement(l.a.Fragment,null,m===it.SITE_CONFIRM&&l.a.createElement(ot,{closeModal:A,onRestore:b,backupInfo:o}),l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{htmlFor:"backup-restore",label:l.a.createElement(E.c,{id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_RESTORE_BACKUP"}),description:l.a.createElement(E.c,{id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_RESTORE_BACKUP_DESCRIPTION"}),searchIsApplicable:"isUdm"}),l.a.createElement(L.a,{column:!0},l.a.createElement(z.b,{name:"backup-restore",onChange:C,variant:"inline"},l.a.createElement(E.c,{id:"COMMON_ACTION_CHOOSE_FILE"})))))});const dt=Object(D.c)(z.c)`
  font-weight: normal;
  font-size: ${({theme:e})=>e.fontSize["font-size-m"]};
  margin-top: ${({theme:e})=>e.spacing["spacing-s"]};
`,Tt=Object(D.c)("div")`
  margin-left: ${({theme:e})=>e.spacing["spacing-s"]};
  padding-top: ${({theme:e})=>e.spacing["spacing-xxs"]};
`;var ut=()=>{const e=Object(i.useSelector)(s.selectLastControllerUpdateQuery),t=Object(i.useSelector)(s.selectLastFirmwareUpdateQuery),a=Object(i.useSelector)(J.b),c=Object(i.useSelector)(b.selectDevicesBasicData),r=Object(i.useSelector)(I.k),o=Object(i.useSelector)(Q.b),_=Object(i.useSelector)(Q.c),m=Object(i.useDispatch)(),d=e=>()=>{const t="controller"===e?Y:H;if(_&&"controller"===e&&a){a.get("updateController").checkControllerUpdate()}const{successToast:n,failureToast:c}=Object($.a)("SETTINGS_SYSTEM_MAINTENANCE_UPDATE_CHECK_FIRMWARE_UPDATES_ERROR_MESSAGE","SETTINGS_SYSTEM_MAINTENANCE_UPDATE_CHECK_UPDATES_SUCCESS",{type:e});m(t()).then(()=>{m(Object(u.c)(n)),m(Object(s.fetchControllerWarnings)()),"firmware"===e&&m(Object(U.fetchAvailableFirmware)())}).catch(e=>{m(Object(u.c)(c(void 0,e)))})};return l.a.createElement(M.a,null,r?l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{htmlFor:"check-controller-package-update",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_CHECK_CONTROLLER_UPDATES_LABEL"})}),l.a.createElement(L.a,{column:!0},l.a.createElement(E.b,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_CHECK_CONTROLLER_UPDATES_UNIFI_OS",values:{link:X(o,v.a.ucoreSettings)}}))):l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{htmlFor:"check-controller-package-update",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_CHECK_CONTROLLER_UPDATES_LABEL"}),description:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_CHECK_CONTROLLER_UPDATES_LABEL_DESCRIPTION"}),searchIgnore:!0}),l.a.createElement(L.a,{column:!0},l.a.createElement(V.i,{lastQuery:e}),l.a.createElement(dt,{name:"check-controller-package-update",type:"button",variant:"inline",onClick:d("controller"),legacy:!1},l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_CHECK_FIRMWARE_UPDATES_BUTTON"})))),l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{htmlFor:"check-firmware-update",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_CHECK_FIRMWARE_UPDATES_LABEL"})}),l.a.createElement(L.a,{column:!0},c.length?l.a.createElement(l.a.Fragment,null,l.a.createElement(V.i,{lastQuery:t}),l.a.createElement(dt,{name:"check-firmware-update",type:"button",variant:"inline",onClick:d("firmware"),legacy:!1},l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_CHECK_FIRMWARE_UPDATES_BUTTON"}))):l.a.createElement(K.g,null,l.a.createElement("div",null,l.a.createElement(j.cb,{isActive:!0})),l.a.createElement(Tt,null,l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_CHECK_FIRMWARE_UPDATES_EMPTY"}))))),l.a.createElement(f.a,{marginBottom:"xxxxl"}),l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{htmlFor:"mgmt.auto_upgrade",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_AUTO_UPGRADE_LABEL"}),alignWith:"toggleSmall"}),l.a.createElement(L.a,{column:!0},l.a.createElement(q.a,{name:"mgmt.auto_upgrade",type:"checkbox"}))),l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_SCHEDULED_UPGRADE_LABEL"}),alignWith:(null==c?void 0:c.length)?n.GRID_TABLE:void 0,htmlFor:"schedule-firmware-upgrades"}),l.a.createElement(L.a,{column:!0,unlimitedWidth:!0},(null==c?void 0:c.length)?l.a.createElement(we,null):l.a.createElement(K.g,null,l.a.createElement("div",null,l.a.createElement(j.cb,{isActive:!0})),l.a.createElement(Tt,null,l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_SCHEDULED_UPGRADE_EMPTY"}))))),r&&l.a.createElement(mt,null),l.a.createElement(f.a,{marginBottom:"xxxxl"}),l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_HEADER_FIRMWARE_CACHE"}),description:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_HEADER_FIRMWARE_CACHE_DESCRIPTION"}),alignWith:n.GRID_TABLE,htmlFor:"device-firmware-cache"}),l.a.createElement(L.a,{column:!0,unlimitedWidth:!0},l.a.createElement(ze,null))))},St=a(148),Nt=a(38);const At=e=>Object(ye.g)({modalType:Nt.a.SSO_LOGIN,modalProps:{title:"SETTINGS_CONTROLLER_ADVANCED_UPDATES_TITLE_MODAL_ENABLE_SSO",submitButtonText:"COMMON_LOGIN",...e}}),Ot=e=>Object(ye.g)({modalType:Nt.a.SSO_LOGIN_2FA,modalProps:{title:"SETTINGS_CONTROLLER_ADVANCED_UPDATES_TITLE_MODAL_ENABLE_SSO",submitButtonText:"SETTINGS_CONTROLLER_ADVANCED_UPDATES_ACTION_MODAL_ENABLE_SSO",...e}});var bt=a(3),Ct=a(275);const pt=[{value:Ct.b.RELEASE,label:"SETTINGS_CONTROLLER_ADVANCED_UPDATES_SELECT_CHANNEL_RELEASE"},{value:Ct.b.RELEASE_CANDIDATE,label:"SETTINGS_CONTROLLER_ADVANCED_UPDATES_SELECT_CHANNEL_RELEASE_CANDIDATE"},{value:Ct.b.BETA,label:"SETTINGS_CONTROLLER_ADVANCED_UPDATES_SELECT_CHANNEL_BETA"},{value:Ct.b.ALPHA,label:"SETTINGS_CONTROLLER_ADVANCED_UPDATES_SELECT_CHANNEL_ALPHA"},{value:Ct.b.INTERNAL,label:"SETTINGS_CONTROLLER_ADVANCED_UPDATES_SELECT_CHANNEL_INTERNAL"}],It=e=>pt.filter(t=>e.includes(t.value)),ht=Object(bt.a)(m.selectAvailableControllerChannels,e=>It(e)),gt=Object(bt.a)(m.selectAvailableFirmwareChannels,e=>It(e)),Mt=Object(D.c)(M.a)`
  margin-top: ${({theme:e})=>e.spacing["spacing-xxxxl"]};
`;var Rt=()=>{const{setFieldValue:e,values:t,resetForm:a,initialValues:n,values:{super_fwupdate:r}}=Object(A.e)(),o=Object(i.useDispatch)(),_=Object(i.useSelector)(ht),d=Object(i.useSelector)(gt),T=Object(i.useSelector)(I.k),O=Object(c.useCallback)(()=>{o(Object(ye.e)()),o(Object(u.c)({icon:S.a.success,message:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_ENABLE_SSO_TOAST_SUCCESS"}))},[o,ye.e,u.c]),b=Object(c.useCallback)(()=>{e("super_fwupdate.sso_enabled",!1),o(Object(ye.e)())},[o,ye.e,e]),C=Object(c.useCallback)(e=>{b(),o(Object(u.c)({icon:S.a.danger,message:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_ENABLE_SSO_TOAST_ERROR",errorMessage:St.a[e],errorValues:e}))},[o,u.c,b]),p=Object(c.useCallback)((...e)=>B(...e)(o),[o,B]),h=Object(c.useCallback)(()=>{const e=O,t=b,a=C;o(At({registerAction:p,onCancel:t,onError:a,onSuccess:e,on2FARequired:n=>{o(Object(ye.e)()),o(Ot({initialValues:n,registerAction:p,onCancel:t,onError:a,onSuccess:e}))}}))},[o,O,b,C,At,B,ye.e,Ot]),M=Object(c.useCallback)(()=>{o(Object(ne.a)({title:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_DISABLE_SSO_MODAL_TITLE",message:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_DISABLE_SSO_MODAL_DESCR",onConfirm:async()=>{o(Object(ye.e)());const e={...r,sso_enabled:!1,controller_channel:m.FW_UPDATE_CHANNELS.RELEASE,firmware_channel:m.FW_UPDATE_CHANNELS.RELEASE};await o(Object(m.saveSuperFwUpdateSettings)(e)),await o(Object(s.fetchControllerWarnings)(void 0,{crudCacheStrategy:{type:N.a.CACHE}})),a({values:{...t,super_fwupdate:e}})},onCancel:async()=>{o(Object(ye.e)()),e("super_fwupdate.sso_enabled",!0),a({values:{...n}})}}))},[o,ne.a,ye.e,m.saveSuperFwUpdateSettings,s.fetchControllerWarnings,e,a,t]),f=Object(c.useCallback)(e=>{e&&!r.sso_enabled?h():!e&&r.sso_enabled&&M()},[o,h,M,r]);return l.a.createElement(Mt,{padding:"none"},l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{htmlFor:"super_fwupdate.sso_enabled",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_ENABLE_SSO_LABEL"}),description:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_ENABLE_SSO_DESCRIPTION"}),alignWith:"toggle"}),l.a.createElement(L.a,null,l.a.createElement(ue.Field,{type:"checkbox",name:"super_fwupdate.sso_enabled",afterChange:f}))),!T&&l.a.createElement(R.a,{disabled:!r.sso_enabled},l.a.createElement(g.SearchableGridLabel,{htmlFor:"super_fwupdate.controller_channel",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_CONTROLLER_CHANNEL_LABEL"}),alignWith:"select",searchIsApplicable:"isNotUdm"}),l.a.createElement(L.a,null,l.a.createElement(ue.Field,{type:"dropdown",name:"super_fwupdate.controller_channel",options:_,translateOptions:!0,full:!0}))),l.a.createElement(R.a,{disabled:!r.sso_enabled},l.a.createElement(g.SearchableGridLabel,{htmlFor:"super_fwupdate.firmware_channel",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FIRMWARE_CHANNEL_LABEL"}),alignWith:"dropdown"}),l.a.createElement(L.a,null,l.a.createElement(ue.Field,{type:"dropdown",name:"super_fwupdate.firmware_channel",options:d,translateOptions:!0,full:!0}))))};var Lt=()=>l.a.createElement(l.a.Fragment,null,l.a.createElement(ut,null),l.a.createElement(M.a,null,l.a.createElement(g.SearchableAccordion,{items:[{id:"advanced",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_RESTORE_ADVANCED_SETTINGS"}),renderContent:()=>l.a.createElement(Rt,null)}],variant:"secondary",multiOpen:!0}))),ft=a(846),Dt=a(32);const jt=[{value:O.b,label:"SETTINGS_CONTROLLER_MAINTENANCE_VALUES_SETTINGS_ONLY"},...(vt=[7,30,60,90,180,365],vt.map(e=>({value:e,label:"COMMON_DATETIME_VALUE_LAST_DAYS",values:{days:e}}))),{value:O.a,label:"SETTINGS_CONTROLLER_MAINTENANCE_VALUES_NO_LIMIT"}];var vt;const Ut=jt[1].value;var Pt=a(1138);const wt=Object(D.c)(K.g)`
  + div {
    margin-left: ${({theme:e})=>e.spacing["spacing-m"]};
  }
`;var Gt=Object(E.f)(({intl:e,amOrPm:t,changeBase:a,disabled:n,parsedCron:{base:r,monthDay:o,month:s,hour:m,minute:d,twelveHourFormat:T,weekDay:u},useTwentyFourHourTime:S,onChangeAmPm:N,onChangeHandler:A,onChangeTwelveHour:O})=>{const b=Object(i.useSelector)(_.u),C=Object(c.useCallback)(t=>t.map(({value:t,label:a})=>({value:t,label:e.formatMessage({id:a})})),[e]),p=Object(c.useMemo)(()=>C(ft.d),[C]),I=Object(c.useMemo)(()=>C(ft.h),[C]),h=Object(c.useMemo)(()=>C(Te.a),[C]),g=Object(c.useMemo)(()=>C(ft.b),[C]),M=m||0===m,R=u||0===u;return l.a.createElement(K.g,{justifyContent:"space-between",alignItems:"flex-end"},l.a.createElement(wt,{flexDirection:"column"},l.a.createElement(_e.a,{color:"secondary"},l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_CRON_LABEL_EVERY"})),l.a.createElement(Ze.a,{onChange:({value:e})=>a(e),options:p,value:r,width:"74px",disabled:n||b})),o&&l.a.createElement(wt,{flexDirection:"column"},l.a.createElement(_e.a,{color:"secondary"},l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_CRON_LABEL_ON_THE"})),l.a.createElement(Ze.a,{onChange:({value:e})=>A(ft.a.MONTH_DAY)(e),options:ft.g,value:+o,width:"40px",disabled:n||b})),s&&l.a.createElement(wt,{flexDirection:"column"},l.a.createElement(_e.a,{color:"secondary"},l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_CRON_LABEL_OF"})),l.a.createElement(Ze.a,{onChange:({value:e})=>A(ft.a.MONTH)(e),options:I,value:+s,width:"80px",disabled:n||b})),R&&l.a.createElement(wt,{flexDirection:"column"},l.a.createElement(_e.a,{color:"secondary"},l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_CRON_LABEL_ON"})),l.a.createElement(Ze.a,{onChange:({value:e})=>A(ft.a.WEEK_DAY)(e),options:h,value:+u,width:"90px",disabled:n||b})),M&&(S?l.a.createElement(wt,{flexDirection:"column"},l.a.createElement(_e.a,{color:"secondary"},l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_CRON_LABEL_AT"})),l.a.createElement(Ze.a,{onChange:({value:e})=>A(ft.a.HOUR)(e),options:ft.j,value:+m,width:"40px",disabled:n||b})):l.a.createElement(wt,{flexDirection:"column"},l.a.createElement(_e.a,{color:"secondary"},l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_CRON_LABEL_AT"})),l.a.createElement(Ze.a,{onChange:({value:e})=>O(e),options:ft.i,value:+T,width:"40px",disabled:n||b}))),r>=0&&l.a.createElement(wt,{flexDirection:"column"},ft.c.HOUR.id===r&&l.a.createElement(_e.a,{color:"secondary"},l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_UPDATE_FORM_SCHEDULED_CRON_LABEL_AT"})),l.a.createElement(Ze.a,{onChange:({value:e})=>A(ft.a.MINUTE)(e),options:ft.f,value:+d,width:"40px",disabled:n||b})),!S&&M&&l.a.createElement(wt,{flexDirection:"column"},l.a.createElement(Ze.a,{onChange:({value:e})=>N(e),options:g,value:t,width:"44px",disabled:n||b})))});const Ft=Object(D.c)("div")`
  width: 100%;

  table th {
    height: 30px !important;
  }
`,yt=Object(D.c)("div")`
  margin-left: ${({theme:e})=>e.spacing["spacing-s"]};
  padding-top: ${({theme:e})=>e.spacing["spacing-xxs"]};
`;var kt=()=>{const e=Object(i.useDispatch)(),t=Object(i.useSelector)(O.j),a=Object(i.useSelector)(_.n),n=Object(i.useSelector)(_.J),r=Object(i.useSelector)(_.L);let o=n;r?o=n.replace(/h{1,2}/,e=>e.toUpperCase()).replace(/ ?a$/,""):(o=n.replace(/H{1,2}/,e=>e.toLowerCase()),/ ?a$/i.test(o)||(o+=" a"));const s=Object(c.useMemo)(()=>(({dateFormat:e,timeFormat:t})=>[{compare:Object(He.a)(({datetime:t})=>Object(Dt.format)(t,e)),id:"date",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_BACKUP_TABLE_HEADER_DATE"}),renderCell:({datetime:t})=>Object(Dt.format)(t,e),sortable:!0},{compare:Object(He.a)(({datetime:e})=>Object(Dt.format)(e,t)),id:"time",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_BACKUP_TABLE_HEADER_TIME"}),renderCell:({datetime:e})=>Object(Dt.format)(e,t),sortable:!0}])({dateFormat:a,timeFormat:o}),[a,o]),m=Object(c.useCallback)(t=>{e(Object(st.i)(t))},[e,st.i]),d=Object(c.useCallback)(t=>{e(Object(O.e)(t))},[e,O.e]),T=Object(c.useCallback)(t=>{e(Object(st.h)(t))},[e,st.h]);return t.length?l.a.createElement(Ft,null,l.a.createElement(ae.a,{columns:s,disableColumnFilters:!0,disableTextPointer:!0,items:t,idField:"filename",renderRowPopoverContent:e=>l.a.createElement(V.h,null,l.a.createElement(V.f,{onClick:()=>m(e),name:"restore"},l.a.createElement(E.c,{id:"COMMON_ACTION_RESTORE"})),l.a.createElement(V.f,{onClick:()=>d(e),name:"download"},l.a.createElement(E.c,{id:"COMMON_ACTION_DOWNLOAD"})),l.a.createElement(V.f,{onClick:()=>T(e),name:"remove"},l.a.createElement(E.c,{id:"COMMON_ACTION_REMOVE"}))),rowHeight:32})):l.a.createElement(K.g,null,l.a.createElement("div",null,l.a.createElement(j.cb,{isActive:!0})),l.a.createElement(yt,null,l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_BACKUP_AVAILABLE_EMPTY"})))};const Ht=Object(D.c)(se.a)`
  margin-top: ${({theme:e})=>e.spacing["spacing-s"]};
`;var Bt=()=>{const[e,t]=Object(c.useState)(Ut),a=Object(i.useDispatch)(),n=Object(i.useSelector)(Pt.a),r=Object(i.useSelector)(Q.c),{values:{super_mgmt:{autobackup_enabled:o}}}=Object(A.e)(),s=Object(c.useCallback)(({value:e},a)=>{t(e)},[t]),_=Object(c.useCallback)(t=>{t.preventDefault(),a(r?Object(st.e)(e):Object(st.d)(e))},[a,e,r]);return l.a.createElement(M.a,{padding:"none"},l.a.createElement(mt,null),l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{htmlFor:"backupDataRetention",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_BACKUP_DOWNLOAD"}),description:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_BACKUP_DOWNLOAD_DESCRIOPTION"}),alignWith:"dropdown",searchIsApplicable:"isNotUdm"}),l.a.createElement(L.a,{column:!0},l.a.createElement(ue.Field,{full:!0,name:"backupDataRetention",onChange:s,options:jt,translateOptions:!0,type:"dropdown",value:e}),l.a.createElement(Ht,{name:"backupDownload",variant:"inline",onClick:_,disabled:n},l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_BACKUP_DOWNLOAD"})))),l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{htmlFor:"super_mgmt.autobackup_enabled",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_BACKUP_CREATE_AUTO"}),description:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_BACKUP_CREATE_AUTO_DESCRIPTION"}),alignWith:"toggleSmall",searchIsApplicable:"isNotUdm"}),l.a.createElement(L.a,{column:!0},l.a.createElement(ue.Field,{name:"super_mgmt.autobackup_enabled",type:"checkbox"}))),l.a.createElement(R.a,{disabled:!o},l.a.createElement(g.SearchableGridLabel,{htmlFor:"super_mgmt.autobackup_cron_expr",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_BACKUP_SCHEDULER"}),description:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_BACKUP_SCHEDULER_DESCRIPTION"}),searchIsApplicable:"isNotUdm"}),l.a.createElement(L.a,{column:!0},l.a.createElement(ft.e,{name:"super_mgmt.autobackup_cron_expr",render:e=>l.a.createElement(Gt,Object.assign({disabled:!o},e))}))),l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{htmlFor:"super_mgmt.autobackup_days",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_BACKUP_DATA_RETENTION"}),alignWith:"dropdown",searchIsApplicable:"isNotUdm"}),l.a.createElement(L.a,{column:!0},l.a.createElement(ue.Field,{full:!0,name:"super_mgmt.autobackup_days",options:jt,translateOptions:!0,type:"dropdown"}))),l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{htmlFor:"super_mgmt.autobackup_max_files",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_BACKUP_MAX_NUMBER_OF_FILES"}),alignWith:"input",searchIsApplicable:"isNotUdm"}),l.a.createElement(L.a,{column:!0},l.a.createElement(ue.Field,{name:"super_mgmt.autobackup_max_files",type:"number",min:1,max:100}))),l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{htmlFor:"available-backups",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_BACKUP_AVAILABLE"}),description:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_BACKUP_AVAILABLE_DESCRIPTION"}),searchIsApplicable:"isNotUdm"}),l.a.createElement(L.a,{column:!0},l.a.createElement(kt,null))))};var xt=()=>l.a.createElement(K.o,null,l.a.createElement(Bt,null)),Yt=a(1933),Wt=a(293),$t=a(622),Vt=a(28),Kt=a(332),zt=a(2253),qt=a(36);const Jt=Object(D.c)(M.a)`
  margin-top: ${({theme:e})=>e.spacing["spacing-xxxxl"]};
`,Qt={update:Qe.a,remove:Qe.a};var Xt=Object(qe.compose)(E.f,Xe.b)(({intl:e,createNotification:t})=>{const[a,n]=Object(c.useState)(!1),[r,o]=Object(c.useState)(!1),[s,d]=Object(c.useState)(!1),[T,A]=Object(c.useState)(!1),[O,b]=Object(c.useState)(Qt),C=Object(i.useDispatch)(),p=Object(i.useSelector)(I.m),h=Object(i.useSelector)(Kt.selectSites),M=Object(i.useSelector)(m.selectFormattedSettings),f=Object(i.useSelector)(Vt.selectNetworksData),D=Object(i.useSelector)(Wt.selectAPGroups),j=Object(i.useSelector)(qt.selectWifiNetworksData),v=Object(i.useSelector)(et.selectDevicesData),U=Object(i.useSelector)(_.v),P=Object(c.useRef)(null),w=Object(Dt.format)(new Date,"YYYYMMDD-HHmm"),G=Object(c.useMemo)(()=>`unifi-${w}.supp`,[]),F=Object(c.useMemo)(()=>`unifi-sys-config-${w}.json`,[]),y=Object(c.useCallback)(async()=>{n(!0);let a=!1;const c=()=>{a=!0,E.remove(),n(!1)},r=()=>a,E=t(l.a.createElement(Je.a,{id:"download-support-information",title:e.formatMessage({id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_FETCHING_INFORMATION"}),downloads:[{id:"support-information-fetch",files:[{filename:G,progress:0,status:e.formatMessage({id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_FETCHING"})}],onCancel:c}],duration:0,notificationType:"DownloadsToast"}))||Qt;try{if(await C(Object(zt.a)()),a)return;const t=t=>{const{loaded:a=0,total:n=1}=t||{},l=a/n*100,r=Math.floor(l),{value:i,unit:o}=Object(ke.d)(n,"bytes"),s=`${Math.round(i)} ${o}`,_=Math.round(l/100*i);let m=t?`${_} / ${s}`:e.formatMessage({id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_DOWNLOADING"});100===r&&(m=e.formatMessage({id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_DOWNLOADED"})),E.update({id:"download-support-information",title:e.formatMessage({id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_FETCHING_INFORMATION"}),downloads:[{id:"support-information-fetch",files:[{filename:G,progress:r,status:m}],onCancel:c}],duration:100===r?2e3:0,notificationType:"DownloadsToast"})};t(),await C(Object($t.c)("/dl/support",G,{fetchConfig:{onDownloadProgress:t}},r))}catch(i){E.remove(),C(Object(u.c)({icon:S.a.danger,message:"COMMON_DOWNLOAD_SUPPORT_FILE_TOAST_FAILED"}))}n(!1)},[n,C]),k=Object(c.useCallback)(()=>o(!1),[o]),H=Object(c.useCallback)(()=>{o(!0);const a=t(l.a.createElement(Je.a,{id:"download-system-configuration",title:e.formatMessage({id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_SYSTEM_CONFIG_FETCHING_INFORMATION"}),downloads:[{id:"system-config-fetch",files:[{filename:F,progress:0,status:e.formatMessage({id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_FETCHING"})}],onCancel:k}],duration:0,notificationType:"DownloadsToast"}))||Qt;b(a);const n={type:N.a.CACHE};let c=0;const r=[Object(I.a)(void 0,{crudCacheStrategy:n}),Object(Kt.fetchSites)(void 0,{crudCacheStrategy:n}),Object(m.fetchSettings)(n),Object(Vt.fetchNetworks)(void 0,{crudCacheStrategy:n}),Object(Wt.fetchAPGroups)(void 0,{crudCacheStrategy:n}),Object(qt.fetchWifiNetworks)(void 0,{crudCacheStrategy:n}),Object(et.fetchDevices)(void 0,{crudCacheStrategy:n})].map((t,n,l)=>C(t).then(()=>(c+=1,a.update({id:"download-system-configuration",title:e.formatMessage({id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_SYSTEM_CONFIG_FETCHING_INFORMATION"}),downloads:[{id:"system-config-fetch",files:[{filename:F,progress:Math.round(c/l.length*100),status:`${c} / ${l.length}`}],onCancel:k}],duration:0,notificationType:"DownloadsToast"}),Promise.resolve())).catch(e=>(a.remove(),Promise.reject(e))));Promise.all(r).then(()=>{A(!0)}).catch(e=>{o(!1),a.remove(),C(Object(u.c)({icon:S.a.danger,message:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_SYSTEM_CONFIG_TOAST_FAILED",errorMessage:St.a[e.apiMsg],errorValues:e}))})},[o,C,b]);Object(c.useEffect)(()=>{if(T){if(A(!1),r){O.update({id:"download-system-configuration",title:e.formatMessage({id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_SYSTEM_CONFIG_FETCHING_INFORMATION"}),downloads:[{id:"system-config-fetch",files:[{filename:F,progress:100,status:e.formatMessage({id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_FETCHED"})}],onCancel:k}],duration:2e3,notificationType:"DownloadsToast"});const t=e=>Object(Yt.a)(e,(e,a)=>a.toString().startsWith("x_")&&"boolean"!=typeof e?"--- secret ---":"object"==typeof e?t(e):e),a=window.URL.createObjectURL(new Blob([JSON.stringify(t({sysinfo:p,sites:h,setting:M,networkconf:f,apgroups:D,wlanconf:j,device:v}))],{type:"application/json"})),n=document.createElement("a");n.href=a,n.download=F,n.target="_blank",P.current.appendChild(n),n.click(),P.current.removeChild(n)}else O.remove();b({...Qt}),o(!1)}},[T,r,O,b]);const B=Object(c.useCallback)(async()=>{d(!0);let a=!1;const n=()=>{a=!0,r.remove(),d(!1)},c=()=>a,r=t(l.a.createElement(Je.a,{id:"download-server-log",title:e.formatMessage({id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_FETCHING_LOGS"}),downloads:[{id:"server-log-fetch",files:[{filename:$t.a,progress:0,status:e.formatMessage({id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_FETCHING"})}],onCancel:n}],duration:0,notificationType:"DownloadsToast"}))||Qt;try{if(await C(Object(zt.a)()),a)return;const t=t=>{const{loaded:a=0,total:c=1}=t||{},l=a/c*100,E=Math.floor(l),{value:i,unit:o}=Object(ke.d)(c,"bytes"),s=`${Math.round(i)} ${o}`,_=Math.round(l/100*i);let m=t?`${_} / ${s}`:e.formatMessage({id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_DOWNLOADING"});100===E&&(m=e.formatMessage({id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_DOWNLOADED"})),r.update({id:"download-server-log",title:e.formatMessage({id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_FETCHING_LOGS"}),downloads:[{id:"server-log-fetch",files:[{filename:$t.a,progress:E,status:m}],onCancel:n}],duration:100===E?2e3:0,notificationType:"DownloadsToast"})};t(),await C(Object($t.c)($t.b,$t.a,{fetchConfig:{onDownloadProgress:t}},c))}catch(E){r.remove(),C(Object(u.c)({icon:S.a.danger,message:"COMMON_DOWNLOAD_LOGS_FILE_TOAST_FAILED"}))}d(!1)},[C,d,t,e]);return l.a.createElement(Jt,{padding:"none"},l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{alignWith:"button",description:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_DOWNLOAD_DESCRIPTION"}),htmlFor:"download-support-information",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_DOWNLOAD"})}),l.a.createElement(L.a,null,l.a.createElement(K.c,{name:"download-support-information",type:"button",variant:"inline",onClick:y,legacy:!1,disabled:a},l.a.createElement(E.c,{id:"COMMON_ACTION_DOWNLOAD"})))),l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{alignWith:"button",htmlFor:"system-configuration",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_SYSTEM_CONFIG"}),searchTags:["DOWNLOAD_SYSTEM_CONFIGURATION"]}),l.a.createElement(L.a,null,l.a.createElement(K.c,{name:"download-system-config",type:"button",variant:"inline",onClick:H,legacy:!1,disabled:r},l.a.createElement(E.c,{id:"COMMON_ACTION_DOWNLOAD"})),l.a.createElement("div",{ref:P}))),U&&l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{alignWith:"button",htmlFor:"download-server-log",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_DOWNLOAD_LOGS"}),searchTags:["SEARCH_TAG_DOWNLOAD_SERVER_LOGS"]}),l.a.createElement(L.a,null,l.a.createElement(K.c,{name:"download-server-logs",type:"button",variant:"inline",onClick:B,legacy:!1,disabled:s},l.a.createElement(E.c,{id:"COMMON_ACTION_DOWNLOAD"})))))}),Zt=a(455);const ea=Object(D.c)(j.e)`
  margin-right: 10px;
  color: ${({theme:e})=>e.motifPalette.warning};
`,ta=Object(D.c)(K.g)`
  margin-top: 25px;
`;var aa=()=>l.a.createElement(l.a.Fragment,null,l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{label:l.a.createElement(E.c,{id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_FIVE_MIN_GRANULARITY"}),htmlFor:"super_mgmt.data_retention_time_in_hours_for_5minutes_scale",alignWith:"dropdown",searchTags:["SEARCH_BREADCRUMB_DATA_RETENTION"]}),l.a.createElement(L.a,null,l.a.createElement(ue.Field,{type:"dropdown",translateOptions:!0,name:"super_mgmt.data_retention_time_in_hours_for_5minutes_scale",options:Zt.b,full:!0}))),l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{label:l.a.createElement(E.c,{id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_HOURLY_GRANULARITY"}),htmlFor:"super_mgmt.data_retention_time_in_hours_for_hourly_scale",alignWith:"dropdown",searchTags:["SEARCH_BREADCRUMB_DATA_RETENTION"]}),l.a.createElement(L.a,null,l.a.createElement(ue.Field,{type:"dropdown",translateOptions:!0,name:"super_mgmt.data_retention_time_in_hours_for_hourly_scale",options:Zt.c,full:!0}))),l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{label:l.a.createElement(E.c,{id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_DAILY_GRANULARITY"}),htmlFor:"super_mgmt.data_retention_time_in_hours_for_daily_scale",alignWith:"dropdown",searchTags:["SEARCH_BREADCRUMB_DATA_RETENTION"]}),l.a.createElement(L.a,null,l.a.createElement(ue.Field,{type:"dropdown",translateOptions:!0,name:"super_mgmt.data_retention_time_in_hours_for_daily_scale",options:Zt.a,full:!0}))),l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{label:l.a.createElement(E.c,{id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_MONTHLY_GRANULARITY"}),htmlFor:"super_mgmt.data_retention_time_in_hours_for_monthly_scale",alignWith:"dropdown",searchTags:["SEARCH_BREADCRUMB_DATA_RETENTION"]}),l.a.createElement(L.a,null,l.a.createElement(ue.Field,{type:"dropdown",translateOptions:!0,name:"super_mgmt.data_retention_time_in_hours_for_monthly_scale",options:Zt.d,full:!0}))),l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{label:l.a.createElement(E.c,{id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_NON_TIME_SERIES"}),htmlFor:"super_mgmt.data_retention_time_in_hours_for_others",alignWith:"dropdown",searchTags:["SEARCH_BREADCRUMB_DATA_RETENTION"]}),l.a.createElement(L.a,null,l.a.createElement(ue.Field,{type:"dropdown",translateOptions:!0,name:"super_mgmt.data_retention_time_in_hours_for_others",options:Zt.e,full:!0}))),l.a.createElement(R.a,null,l.a.createElement(g.SearchableGridLabel,{label:l.a.createElement(E.c,{id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_CLIENTS_DATA"}),htmlFor:"super_mgmt.time_series_per_client_stats_enabled",alignWith:"toggleSmall",searchTags:["SEARCH_BREADCRUMB_DATA_RETENTION"]}),l.a.createElement(L.a,{column:!0},l.a.createElement(ue.Field,{type:"checkbox",name:"super_mgmt.time_series_per_client_stats_enabled"}),l.a.createElement(ta,null,l.a.createElement(ea,null),l.a.createElement(_e.a,{size:"caption",color:"tertiary"},l.a.createElement(E.c,{id:"SETTINGS_CONTROLLER_MAINTENANCE_LABEL_CLIENTS_DATA_WARNING"}))))));var na=({formValues:e})=>{const t=Object(c.useRef)(null),{errors:a,resetForm:n,status:o}=Object(A.e)(),d=Object(i.useSelector)(_.v),T=Object(i.useSelector)(I.k),u=Object(c.useMemo)(()=>[d&&{id:"data-retention",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_DATA_RETENTION_NAME"}),renderContent:()=>l.a.createElement(aa,null)},!T&&d&&{id:"backup",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_BACKUP_RESTORE_NAME"}),renderContent:()=>l.a.createElement(xt,null)},{id:"support-information",label:l.a.createElement(E.c,{id:"SETTINGS_SYSTEM_MAINTENANCE_SUPPORT_INFORMATION_NAME"}),renderContent:()=>l.a.createElement(Xt,null)}].filter(e=>!!e),[T,d]);return Object(c.useEffect)(()=>{o.isSubmitted&&n({values:e})},[e,n,o.isSubmitted]),Object(r.f)(t,a),Object(r.e)([Object(O.f)({type:N.a.CACHE}),Object(s.fetchControllerWarnings)(void 0,{crudCacheStrategy:{type:N.a.CACHE}}),Object(b.fetchDevicesBasic)({},{type:N.a.CACHE}),Object(C.fetchScheduledUpgrades)({type:N.a.CACHE}),Object(p.fetchSdn)({type:N.a.CACHE}),Object(m.fetchSettings)({type:N.a.CACHE}),Object(I.a)(void 0,{crudCacheStrategy:{type:N.a.CACHE}}),Object(h.a)(void 0,{crudCacheStrategy:{type:N.a.CACHE}})],l.a.createElement("div",{ref:t},l.a.createElement(Lt,null),l.a.createElement(g.SearchableAccordion,{items:u,multiOpen:!0})))},ca=a(30);const la=ca.a.object().shape({super_mgmt:ca.a.object().shape({autobackup_max_files:ca.a.number().label("SETTINGS_SYSTEM_MAINTENANCE_BACKUP_MAX_NUMBER_OF_FILES").required().min(1).max(100)})});var ra=({onBack:e})=>{const t=Object(i.useDispatch)(),a=Object(i.useSelector)(_.u),n=Object(i.useSelector)(m.selectSuperFwUpdateSettings),r=Object(i.useSelector)(m.selectSuperManagementSettings),A=Object(i.useSelector)(m.selectMgmtSettings),O=Object(c.useMemo)(()=>({mgmt:{...d.mgmt,...A},super_mgmt:{...d.super_mgmt,...r},super_fwupdate:{...d.super_fwupdate,...n}}),[A,n,r]),b=Object(c.useMemo)(()=>({isSubmitted:!1}),[]),C=Object(c.useMemo)(()=>({component:l.a.createElement(E.c,{id:"SETTINGS_MAINTENANCE_FORM_TITLE"}),message:"maintenance"}),[]),p=Object(c.useCallback)((e,{setStatus:a,setSubmitting:n})=>{const{mgmt:c,super_mgmt:l,super_fwupdate:r}=e,E=[];Object(o.a)(l,O.super_mgmt)||E.push(t(Object(m.saveSettings)(l))),Object(o.a)(c,O.mgmt)||E.push(t(Object(m.saveSettings)(c))),Object(o.a)(r,O.super_fwupdate)||E.push(t(Object(m.saveSuperFwUpdateSettings)(r))),Promise.all(E).then(()=>{t(Object(u.c)({icon:S.a.success,message:"SETTINGS_CONTROLLER_MAINTENANCE_SAVE_SUCCESS"})),a({isSubmitted:!0}),t(Object(s.fetchControllerWarnings)(void 0,{crudCacheStrategy:{type:N.a.CACHE}}))}).catch(e=>{t(Object(u.c)({errorMessage:e.msg,errorValues:e,icon:S.a.danger,message:"SETTINGS_CONTROLLER_MAINTENANCE_SAVE_ERROR"})),n(!1)})},[t,O]);return l.a.createElement(T.b,{goBack:e,hideClose:!0,initialStatus:b,initialValues:O,isEdit:!a,isView:a,showBack:!0,title:C,validationSchema:la,onEscClicked:e,onSubmit:p,unsavedChangesModalIgnoredPaths:[/\/schedule-upgrades((\/)|(\/[a-zA-Z0-9_-]+\/?))?$/]},l.a.createElement(na,{formValues:O}))};t.default=()=>{const e=Object(r.g)();return l.a.createElement(ra,{onBack:e})}},2113:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return d}));var n=a(15),c=a.n(n),l=a(2),r="/v2/api/timezones";function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){c()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(l.o)("timezones",r,e,i({idField:"timezone"},t))},s=a(16),_=a(3),m=Object(l.x)(o()),d=Object(_.a)((function(e){return Object(s.a)(m(e),"data",[])}),(function(e){return e.map((function(e){return{label:"(UTC".concat(e.offset,") ").concat(e.timezone.replace(/_/g," ")),value:e.timezone}}))}))},2206:function(e,t,a){"use strict";var n=a(0),c=a.n(n),l=a(1860),r=a(1969),E=a(5);const i=Object(E.c)("div",{shouldForwardProp:e=>!["height","maxWidth","headerHeight"].includes(e)})`
  height: ${({height:e})=>e}px;
  ${({maxWidth:e})=>e?`max-width: ${e}px;`:""}
  ${({headerHeight:e})=>e?`table {\n    th {\n      height: ${e}px !important;\n    }\n  }`:""}
`;t.a=function({maxRows:e=6,headerHeight:t,maxWidth:a,forwardedRef:E,rowHeight:o,items:s,..._}){const m=Object(n.useMemo)(()=>r.b.getHeight(s.length,6,t,o)+1,[t,s.length,o]);return c.a.createElement(i,{height:m,maxWidth:a,headerHeight:t},c.a.createElement(l.a,Object.assign({ref:E,rowHeight:o,items:s},_)))}},2209:function(e,t,a){"use strict";var n=a(2210);a.d(t,"fetchScheduledUpgrades",(function(){return n.a})),a.d(t,"removeScheduledUpgrade",(function(){return n.b})),a.d(t,"saveScheduledUpgrade",(function(){return n.c}));a(2261);var c=a(2296);a.d(t,"selectScheduledUpgrades",(function(){return c.a}));a(2297)},2210:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return E}));var n=a(2),c=a(2261);const l=e=>Object(n.o)(c.a,c.b+"?action=upgrade",void 0,{crudCacheStrategy:e,idField:"_id"}),r=e=>t=>{const{_id:a}=e;return t(a?Object(n.y)(c.a,a,`${c.b}/${a}`,{action:"upgrade",...e}):Object(n.h)(c.a,c.b,{action:"upgrade",...e}))},E=e=>Object(n.l)(c.a,e,`${c.b}/${e}`)},2211:function(e,t,a){"use strict";var n=a(2257);a.d(t,"downloadFirmwareAndRefresh",(function(){return n.a})),a.d(t,"fetchAvailableFirmware",(function(){return n.b})),a.d(t,"fetchCachedFirmware",(function(){return n.c})),a.d(t,"removeFirmwareAndRefresh",(function(){return n.d}));var c=a(2298);a.d(t,"selectCachedSiteFirmwares",(function(){return c.a})),a.d(t,"selectSiteFirmwares",(function(){return c.b}));a(2299)},2253:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return m}));var n=a(389),c=a.n(n),l=a(817),r=a.n(l),E=a(37),i=a(2),o=(a(21),a(42),a(97)),s=function(){var e=window.navigator,t=e.userAgent,a=e.language;return Object(i.n)(E.a.SUPPORT,"/api/s/{site}/cmd/system",{userAgent:t,language:a})},_=function(e){return function(t){return t(function(e){return Object(i.n)(E.a.SET_PARAM,"/api/s/{site}/cmd/system",e)}(e))}},m=function(e){return function(){var t=r()(c.a.mark((function t(a){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.map((function(e){return a(_(e))})));case 2:if(!e.length){t.next=5;break}return t.next=5,a(Object(o.a)());case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},2257:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return E})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return o}));var n=a(2);var c=a(37);const l=({device:e,version:t})=>`${e}_${t}`,r=e=>Object(n.o)("availableFirmware","/api/s/{site}/cmd/firmware",{data:{cmd:c.a.LIST_AVAILABLE_FIRMWARE}},{method:"post",idField:l,crudCacheStrategy:e}),E=e=>Object(n.o)("cachedFirmware","/api/s/{site}/cmd/firmware",{data:{cmd:c.a.LIST_CACHED_FIRMWARE}},{method:"post",idField:l,crudCacheStrategy:e}),i=(e,t)=>async a=>{await a(((e,t)=>Object(n.n)(c.a.DOWNLOAD_FIRMWARE,"/api/s/{site}/cmd/firmware",{device:e,version:t}))(e,t)),await a(E()),await a(r())},o=(e,t)=>async a=>{await a(((e,t)=>Object(n.n)(c.a.REMOVE_FIRMWARE,"/api/s/{site}/cmd/firmware",{device:e,version:t}))(e,t)),await a(r()),await a(E())}},2261:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return c}));const n="scheduledUpgrades",c="/api/s/{site}/rest/scheduletask"},2296:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(3),c=a(22),l=a(2),r=a(2210);const E=Object(l.x)(Object(r.a)()),i=Object(n.a)(E,c.c)},2297:function(e,t){var a,n;!function(e){e.STREAM="stream",e.BACKUP="backup",e.UPGRADE="upgrade",e.RADIOAI="radio-ai",e.ANALYTICS="analytics"}(a||(a={})),function(e){e.MEDIA="media",e.SAMPLE="sample"}(n||(n={}))},2298:function(e,t,a){"use strict";a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return T}));var n=a(3),c=a(2477),l=a(22),r=a(2),E=a(2257);const i=Object(r.x)(Object(E.b)()),o=Object(n.a)(i,l.c),s=Object(r.x)(Object(E.c)()),_=Object(n.a)(s,l.c),m=Object(n.a)(o,_,(e,t)=>Object(c.a)([...e.map(e=>({...e,id:`${e.device}_${e.version}`})),...t.map(e=>({...e,id:`${e.device}_${e.version}`}))],"id")),d=Object(n.a)(m,e=>e.filter(({siteDevice:e})=>e)),T=Object(n.a)(_,e=>e.filter(({siteDevice:e})=>e));Object(n.a)(m,e=>e.filter(({cached:e,knownDevice:t,siteDevice:a})=>e||t||a))},2299:function(e,t){},2300:function(e,t,a){var n={"./en-au":2160,"./en-au.js":2160,"./en-ca":2161,"./en-ca.js":2161,"./en-gb":2162,"./en-gb.js":2162,"./en-ie":2163,"./en-ie.js":2163,"./en-il":2164,"./en-il.js":2164,"./en-in":2165,"./en-in.js":2165,"./en-nz":2166,"./en-nz.js":2166,"./en-sg":2167,"./en-sg.js":2167};function c(e){var t=l(e);return a(t)}function l(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}c.keys=function(){return Object.keys(n)},c.resolve=l,e.exports=c,c.id=2300},2494:function(e,t){}}]);