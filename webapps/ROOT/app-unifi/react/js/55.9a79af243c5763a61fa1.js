(window.webpackJsonpunifiNetworkUi=window.webpackJsonpunifiNetworkUi||[]).push([[55],{1808:function(e,t,a){"use strict";a.r(t);var E=a(0),n=a.n(E),l=a(4),i=a(8),r=a(458),T=a(230),_=a.n(T),c=a(6),s=a(173),o=a(392),N=a(268),A=a(28),u=a(13),S=a(42),d=a(97),R=a(1945),I=a(21),m=a(64),p=a(18),O=a(2),b=a(2056),L=a(5),G=a(31),M=a(45),g=a(49),C=a(95),D=a(75),f=a(1753),v=a(54);const h=({isIpsEnabled:e,sensitivity:t,...a})=>t=>t(Object(S.saveSettings)({...a,ips_mode:e?a.ips_mode:S.IpsMode.DISABLED,suppression:{...a.suppression,whitelist:a.suppression.whitelist.map(({id:e,...t})=>t)}}));var V,P=a(2020),F=a(671),U=a(1754),y=a(1972),x=a(1950),j=a(1141),W=a(69),w=a(33),H=a(1946),k=a(199),B=a(23),Y=a(1924),K=a(1755),$=a(98),z=a(2094),q=a(30),X=a(2039),J=a(2008);!function(e){e.CREATE="create",e.EDIT="edit",e.REMOVE="remove"}(V||(V={}));var Q=a(16);const Z=Object(L.c)(C.g)`
  margin-left: 8px;
  margin-right: 8px;

  &:first-child {
    margin-left: 0;
  }

  &:last-child {
    margin-right: 0;
  }
`,ee=[{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_DIRECTION_BOTH",value:S.IpsSuppressionDirection.BOTH},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_DIRECTION_SRC",value:S.IpsSuppressionDirection.SOURCE},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_DIRECTION_DEST",value:S.IpsSuppressionDirection.DESTINATION}],te=[{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_MODE_IP",value:S.IpsSuppressionMode.IP_ADDRESS},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_MODE_NETWORK",value:S.IpsSuppressionMode.NETWORK},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_MODE_SUBNET",value:S.IpsSuppressionMode.SUBNET}];var ae=({trackingEntry:e,...t})=>{const{setFieldValue:a,values:l}=Object(M.e)(),r=Object(i.useSelector)(A.selectNetworksData),T=Object(E.useMemo)(()=>r.filter(({ip_subnet:e})=>!!e).map(({_id:e,name:t})=>({value:e,label:t})),[r]),_=Object(E.useCallback)(()=>a("tracking",l.tracking.filter(t=>t!==e)),[a,e,l.tracking]),c=`tracking[${l.tracking.findIndex(t=>t===e)}]`,s=c+".direction",o=c+".mode",N=c+".valueIp",u=c+".valueNetwork",d=c+".valueSubnet";return n.a.createElement(U.a,Object.assign({},t),n.a.createElement(K.a,{unlimitedWidth:!0},n.a.createElement(Z,{flex:"1 1 0",flexDirection:"column"},n.a.createElement(v.Field,{full:!0,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_FORM_FIELD_DIRECTION",name:s,options:ee,translateLabel:!0,translateOptions:!0,type:"dropdown"})),n.a.createElement(Z,{flex:"1 1 0",flexDirection:"column"},n.a.createElement(v.Field,{full:!0,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_FORM_FIELD_MODE",name:o,options:te,translateLabel:!0,translateOptions:!0,type:"dropdown"})),Object(Q.a)(l,o)===S.IpsSuppressionMode.IP_ADDRESS&&n.a.createElement(Z,{flex:"1 1 0",flexDirection:"column"},n.a.createElement(v.Field,{full:!0,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_FORM_FIELD_VALUE_IP",name:N,placeholder:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_FORM_FIELD_VALUE_IP_PLACEHOLDER"})),Object(Q.a)(l,o)===S.IpsSuppressionMode.NETWORK&&n.a.createElement(Z,{flex:"1 1 0",flexDirection:"column"},n.a.createElement(v.Field,{full:!0,name:u,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_FORM_FIELD_VALUE_NETWORK",options:T,translateLabel:!0,type:"dropdown"})),Object(Q.a)(l,o)===S.IpsSuppressionMode.SUBNET&&n.a.createElement(Z,{flex:"1 1 0",flexDirection:"column"},n.a.createElement(v.Field,{full:!0,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_FORM_FIELD_VALUE_SUBNET",name:d,placeholder:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_FORM_FIELD_VALUE_SUBNET_PLACEHOLDER"})),n.a.createElement(Z,{alignItems:"center",alignSelf:"stretch",flex:"none"},n.a.createElement(C.c,{legacy:!1,name:"threat-management-alerts-form-remove-tracking-entry",type:"button",variant:"inline",onClick:_},n.a.createElement(B.cc,null)))))};const Ee=Object(L.c)(C.g)`
  > :last-child {
    margin-left: 8px !important;
  }
`,ne=Object(L.c)(z.a)`
  width: 512px !important;
`,le=Object(L.c)(Y.a)`
  flex: 1 2 136px !important;
`,ie=q.a.object().shape({tracking:q.a.array().of(q.a.object().shape({direction:q.a.string().oneOf(Object.values(S.IpsSuppressionDirection)).required(),mode:q.a.string().oneOf(Object.values(S.IpsSuppressionMode)).required(),valueIp:q.a.string().when("mode",{is:S.IpsSuppressionMode.IP_ADDRESS,then:q.a.string().label("SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_FIELD_VALUE_IP").matches(Object(J.e)([$.h,$.k]),n.a.createElement(l.c,{id:"COMMON_VALIDATION_VALID_IP"})).required()}),valueNetwork:q.a.string().when("mode",{is:S.IpsSuppressionMode.NETWORK,then:q.a.string().label("SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_FIELD_VALUE_NETWORK").required()}),valueSubnet:q.a.string().when("mode",{is:S.IpsSuppressionMode.SUBNET,then:q.a.string().label("SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_FIELD_VALUE_SUBNET").test("networkSubnet",n.a.createElement(l.c,{id:"COMMON_VALIDATION_VALID_NETWORK_SUBNET"}),X.a).required()})}))});var re=({saveSuppression:e})=>{var t,a;const r=Object(m.h)("security/threat-management"),T=Object(G.k)(),{inlineFormEntityId:c}=Object(G.m)(),{values:{ips:{suppression:{alerts:s}}}}=Object(M.e)(),o=s.find(({id:e})=>String(e)===c),N=null!==(a=null===(t=Object(i.useSelector)(A.selectNetworksData).find(({attr_hidden_id:e})=>"LAN"===e))||void 0===t?void 0:t._id)&&void 0!==a?a:"",u=Object(E.useMemo)(()=>{var e,t;return{...o,tracking:null!==(t=null===(e=o.tracking)||void 0===e?void 0:e.map(({mode:e,value:t,...a})=>({id:_()(),mode:e,valueIp:e===S.IpsSuppressionMode.IP_ADDRESS?t:"",valueNetwork:e===S.IpsSuppressionMode.NETWORK?t:N,valueSubnet:e===S.IpsSuppressionMode.SUBNET?t:"",...a})))&&void 0!==t?t:[]}},[o,N]),d=Object(E.useCallback)(()=>T.push(r),[T,r]),R=Object(E.useCallback)((t,{setSubmitting:a})=>{const{tracking:E,...n}=t,l=E.map(({id:e,mode:t,valueIp:a,valueNetwork:E,valueSubnet:n,...l})=>{let i;switch(t){case S.IpsSuppressionMode.IP_ADDRESS:i=a;break;case S.IpsSuppressionMode.NETWORK:i=E;break;case S.IpsSuppressionMode.SUBNET:i=n;break;default:i=""}return{mode:t,value:i,...l}});e(V.EDIT,{tracking:l,...n},a,d)},[e,d]);return n.a.createElement(M.c,{initialValues:u,validationSchema:ie,onSubmit:R},({handleSubmit:e,isSubmitting:t,setFieldValue:a,values:E})=>n.a.createElement(ne,{actions:[{text:n.a.createElement(l.c,{id:"COMMON_ACTION_CANCEL"}),type:"button",onClick:d},{disabled:t,text:n.a.createElement(l.c,{id:"COMMON_ACTION_SAVE"}),type:"submit",variant:"primary",onClick:()=>e()}],title:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_FORM_TITLE_EDIT"}),onRequestClose:d},n.a.createElement("form",{onSubmit:e},n.a.createElement(f.a,{padding:"none"},n.a.createElement(U.a,null,n.a.createElement(le,{disableHover:!0,label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_FORM_FIELD_CATEGORY"})}),n.a.createElement(K.a,{column:!0,unlimitedWidth:!0},n.a.createElement(l.c,{id:E.category}))),n.a.createElement(U.a,null,n.a.createElement(le,{disableHover:!0,label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_FORM_FIELD_SIGNATURE"})}),n.a.createElement(K.a,{column:!0,unlimitedWidth:!0},E.signature)),n.a.createElement(U.a,null,n.a.createElement(le,{alignWith:9,htmlFor:"type",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_FORM_FIELD_TYPE"})}),n.a.createElement(K.a,{unlimitedWidth:!0},n.a.createElement(v.Field,{name:"type",toggleboxType:"radio",type:"togglebox",value:S.IpsSuppressionType.ALL},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_TYPE_ALL"})),n.a.createElement(v.Field,{name:"type",toggleboxType:"radio",type:"togglebox",value:S.IpsSuppressionType.TRACK},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_TYPE_TRACK"})))),E.type===S.IpsSuppressionType.TRACK&&n.a.createElement(n.a.Fragment,null,E.tracking.map(e=>n.a.createElement(ae,{key:e.id,trackingEntry:e})),n.a.createElement(U.a,null,n.a.createElement(K.a,{unlimitedWidth:!0},n.a.createElement(C.c,{legacy:!1,name:"threat-management-alerts-form-add-new-tracking-entry",type:"button",variant:"inline",onClick:()=>a("tracking",E.tracking.concat({direction:S.IpsSuppressionDirection.BOTH,id:_()(),mode:S.IpsSuppressionMode.IP_ADDRESS,valueIp:"",valueNetwork:N,valueSubnet:""}))},n.a.createElement(Ee,{alignItems:"center",flex:"none"},n.a.createElement(B.ub,null),n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_FORM_BUTTON_ADD"}))))))))))};const Te=e=>{switch(e){case S.IpsSuppressionDirection.BOTH:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_DIRECTION_BOTH";case S.IpsSuppressionDirection.DESTINATION:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_DIRECTION_DEST";case S.IpsSuppressionDirection.SOURCE:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_DIRECTION_SRC";default:return"COMMON_UNKNOWN"}},_e=e=>{switch(e){case S.IpsSuppressionMode.IP_ADDRESS:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_MODE_IP";case S.IpsSuppressionMode.NETWORK:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_MODE_NETWORK";case S.IpsSuppressionMode.SUBNET:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_MODE_SUBNET";default:return"COMMON_UNKNOWN"}},ce=Object(L.c)("span")`
  margin-bottom: 4px;

  &:first-child {
    margin-top: 4px;
  }
`,se=Object(L.c)(U.a)`
  margin-bottom: 24px !important;
  padding-top: 32px;
`;var oe=Object(l.f)(({intl:e,saveSuppression:t})=>{const a=Object(m.h)("security/threat-management/"+P.a.ALERTS),r=Object(G.k)(),{inlineForm:T}=Object(G.m)(),_=T===P.a.ALERTS,{setSubmitting:c,values:s}=Object(M.e)(),o=Object(i.useSelector)(k.b),N=Object(i.useSelector)(A.selectNetworksData),u=Object(i.useSelector)(W.a),d=Object(i.useSelector)(w.c),[R,I]=Object(E.useState)(null),p=Object(E.useMemo)(()=>{const t=Object(H.b)(e),a=(t,a)=>a===S.IpsSuppressionType.ALL?[e.formatMessage({id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_TYPE_ALL"})]:t&&0!==t.length?t.map(({mode:e,value:t})=>{var a;return(e===S.IpsSuppressionMode.NETWORK?null===(a=N.find(({_id:e})=>e===t))||void 0===a?void 0:a.name:t)||""}):[""],E=e=>e?e.replace(/^SETTINGS_/,""):"IPS_CATEGORY_UNKNOWN",i=(t,a)=>a===S.IpsSuppressionType.TRACK&&t&&0!==t.length?t.map(({direction:t})=>e.formatMessage({id:Te(t)})):[""];return[{compare:t(({_:e,category:t})=>E(t)),id:"alerts-category",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_TABLE_CATEGORY"}),renderCell:({category:e})=>n.a.createElement(l.c,{id:E(e)}),minWidth:115,maxWidth:160},{compare:Object(H.a)(({signature:e})=>null==e?void 0:e.toLowerCase()),id:"alerts-signature",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_TABLE_SIGNATURE"}),renderCell:({signature:e})=>e,minWidth:150},{compare:Object(H.a)(({tracking:e,type:t})=>a(e,t).join(" ")),id:"alerts-allow",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_TABLE_ALLOW"}),renderCell:({tracking:e,type:t})=>n.a.createElement(C.g,{flex:"1",flexDirection:"column"},a(e,t).map((e,t)=>n.a.createElement(ce,{key:t},e))),minWidth:100,maxWidth:145},{compare:Object(H.a)(({tracking:e,type:t})=>i(e,t).join(" ")),id:"alerts-direction",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_TABLE_DIRECTION"}),renderCell:({tracking:e,type:t})=>n.a.createElement(C.g,{flex:"1",flexDirection:"column"},i(e,t).map((e,t)=>n.a.createElement(ce,{key:t},e))),minWidth:100,maxWidth:145}]},[e,N]),O=Object(E.useCallback)(e=>n.a.createElement(x.h,null,n.a.createElement(C.b,null,n.a.createElement(C.c,{legacy:!1,name:"internet-threat-management-advanced-alerts-edit",type:"button",variant:"inline",onClick:()=>r.push(`${a}/${e.id}`)},n.a.createElement(l.c,{id:"COMMON_ACTION_EDIT"})),n.a.createElement(C.c,{legacy:!1,name:"internet-threat-management-advanced-alerts-remove",type:"button",variant:"inline",onClick:()=>I(e)},n.a.createElement(l.c,{id:"COMMON_ACTION_REMOVE"}))),n.a.createElement(C.m,null,n.a.createElement(C.c,{legacy:!1,name:"internet-threat-management-advanced-alerts-view",type:"button",variant:"inline",onClick:()=>r.push(`${a}/${e.id}`)},n.a.createElement(l.c,{id:"COMMON_ACTION_VIEW"})))),[]),b=Object(E.useCallback)(()=>I(null),[I]),L=Object(E.useCallback)(()=>t(V.REMOVE,R,c,()=>I(null)),[R,t,I,c]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(f.a,{padding:"none"},n.a.createElement(se,null,n.a.createElement(y.a,{disableColumnFilters:!0,disableSelection:!0,disableTextPointer:!0,columns:p,items:s.ips.suppression.alerts,renderRowPopoverContent:O})),n.a.createElement(U.a,null,d?n.a.createElement(C.c,{legacy:!1,name:"internet-threat-management-advanced-alerts-go-to-ips",type:"button",variant:"inline",onClick:()=>o("manage.site.ufsdn.ips")},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_BUTTON_GO_TO_IPS"})):n.a.createElement(F.Link,{to:`/${u}/ips/dashboard`},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_BUTTON_GO_TO_IPS"})))),_&&n.a.createElement(re,{saveSuppression:t}),R&&n.a.createElement(j.a,{dontHideModalOnConfirm:!0,name:e.formatMessage({id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_CONFIRM_REMOVE_MODAL_NAME"},{signature:R.signature}),onCancel:b,onConfirm:L}))}),Ne=a(464),Ae=a(20);const ue=Object(L.c)(z.a,{shouldForwardProp:e=>"isEdit"!==e})`
  width: 480px !important;

  ${({isEdit:e})=>e&&"& > footer > div {\n      width: 100%;\n\n      & > div:first-child {\n        margin-right: auto;\n      }\n    }"}
`,Se=Object(L.c)(Y.a)`
  flex: 1 2 96px !important;
`,de=q.a.object().shape({direction:q.a.string().oneOf(Object.values(S.IpsSuppressionDirection)).required(),mode:q.a.string().oneOf(Object.values(S.IpsSuppressionMode)).required(),valueIp:q.a.string().when("mode",{is:S.IpsSuppressionMode.IP_ADDRESS,then:q.a.string().label("SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_FIELD_VALUE_IP").matches(Object(J.e)([$.h,$.k]),n.a.createElement(l.c,{id:"COMMON_VALIDATION_VALID_IP"})).required()}),valueNetwork:q.a.string().when("mode",{is:S.IpsSuppressionMode.NETWORK,then:q.a.string().label("SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_FIELD_VALUE_NETWORK").required()}),valueSubnet:q.a.string().when("mode",{is:S.IpsSuppressionMode.SUBNET,then:q.a.string().label("SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_FIELD_VALUE_SUBNET").test("networkSubnet",n.a.createElement(l.c,{id:"COMMON_VALIDATION_VALID_NETWORK_SUBNET"}),X.a).required()})});var Re=({saveSuppression:e})=>{const t=Object(m.h)("security/threat-management"),a=Object(i.useDispatch)(),r=Object(G.k)(),{inlineFormEntityId:T}=Object(G.m)(),{values:{ips:{suppression:{whitelist:_}}},setSubmitting:c}=Object(M.e)(),s=_.find(({id:e})=>e===T),o=!(!T||!s),N=Object(i.useSelector)(A.selectNetworksData),u=Object(E.useMemo)(()=>{var e,t;return{direction:S.IpsSuppressionDirection.BOTH,mode:S.IpsSuppressionMode.IP_ADDRESS,...s,valueIp:(null==s?void 0:s.mode)===S.IpsSuppressionMode.IP_ADDRESS?null==s?void 0:s.value:"",valueNetwork:(null==s?void 0:s.mode)===S.IpsSuppressionMode.NETWORK?null==s?void 0:s.value:null!==(t=null===(e=N.find(({attr_hidden_id:e})=>"LAN"===e))||void 0===e?void 0:e._id)&&void 0!==t?t:"",valueSubnet:(null==s?void 0:s.mode)===S.IpsSuppressionMode.SUBNET?null==s?void 0:s.value:""}},[N,s]),d=Object(E.useMemo)(()=>N.filter(({ip_subnet:e})=>!!e).map(({_id:e,name:t})=>({value:e,label:t})),[N]),R=Object(E.useCallback)(()=>r.push(t),[r,t]),I=Object(E.useCallback)((t,{setSubmitting:a})=>{const{valueIp:E,valueNetwork:n,valueSubnet:l,...i}=t;let r;switch(t.mode){case S.IpsSuppressionMode.IP_ADDRESS:r=E;break;case S.IpsSuppressionMode.NETWORK:r=n;break;case S.IpsSuppressionMode.SUBNET:r=l;break;default:r=""}e(o?V.EDIT:V.CREATE,{...i,value:r},a,R)},[o,e,R]),p=Object(E.useCallback)((e,t)=>{var a;return(e===S.IpsSuppressionMode.NETWORK?null===(a=N.find(({_id:e})=>e===t))||void 0===a?void 0:a.name:t)||""},[N]),O=Object(E.useCallback)(()=>{const t=p(u.mode,u[`value${u.mode.charAt(0).toUpperCase()}${u.mode.slice(1)}`]);a(Object(Ne.a)({title:"COMMON_QUESTION_REMOVE",titleValues:{name:t},message:"COMMON_QUESTION_ARE_YOU_SURE_YOU_WANT_TO_REMOVE",messageValues:{name:t},onConfirm:()=>{e(V.REMOVE,u,c,()=>{a(Object(Ae.e)()),R()})}}))},[a,p,u,R,e,c]);return n.a.createElement(M.c,{initialValues:u,validationSchema:de,onSubmit:I},({handleSubmit:e,isSubmitting:t,values:a})=>{var E,i;return n.a.createElement(ue,{actions:[o&&{disabled:t,text:n.a.createElement(l.c,{id:"COMMON_ACTION_REMOVE"}),type:"button",variant:"default",onClick:O},{text:n.a.createElement(l.c,{id:"COMMON_ACTION_CANCEL"}),type:"button",onClick:R},{disabled:t,text:n.a.createElement(l.c,{id:"COMMON_ACTION_SAVE"}),type:"submit",variant:"primary",onClick:()=>e()}],title:n.a.createElement(l.c,{id:o?"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_TITLE_EDIT":"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_TITLE_ADD",values:o?{value:s.mode===S.IpsSuppressionMode.NETWORK?null!==(i=null===(E=N.find(({_id:e})=>e===s.value))||void 0===E?void 0:E.name)&&void 0!==i?i:"":s.value}:{}}),onRequestClose:R,isEdit:o},n.a.createElement("form",{onSubmit:e},n.a.createElement(f.a,{padding:"none"},n.a.createElement(U.a,null,n.a.createElement(Se,{alignWith:9,htmlFor:"direction",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_FIELD_DIRECTION"})}),n.a.createElement(K.a,{unlimitedWidth:!0},n.a.createElement(v.Field,{name:"direction",toggleboxType:"radio",type:"togglebox",value:S.IpsSuppressionDirection.BOTH},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_DIRECTION_BOTH"})),n.a.createElement(v.Field,{name:"direction",toggleboxType:"radio",type:"togglebox",value:S.IpsSuppressionDirection.SOURCE},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_DIRECTION_SRC"})),n.a.createElement(v.Field,{name:"direction",toggleboxType:"radio",type:"togglebox",value:S.IpsSuppressionDirection.DESTINATION},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_DIRECTION_DEST"})))),n.a.createElement(U.a,null,n.a.createElement(Se,{alignWith:9,htmlFor:"direction",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_FIELD_MODE"})}),n.a.createElement(K.a,{unlimitedWidth:!0},n.a.createElement(v.Field,{name:"mode",toggleboxType:"radio",type:"togglebox",value:S.IpsSuppressionMode.IP_ADDRESS},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_MODE_IP"})),n.a.createElement(v.Field,{name:"mode",toggleboxType:"radio",type:"togglebox",value:S.IpsSuppressionMode.NETWORK},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_MODE_NETWORK"})),n.a.createElement(v.Field,{name:"mode",toggleboxType:"radio",type:"togglebox",value:S.IpsSuppressionMode.SUBNET},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_SUPPRESSION_MODE_SUBNET"})))),a.mode===S.IpsSuppressionMode.IP_ADDRESS&&n.a.createElement(U.a,null,n.a.createElement(Se,{alignWith:"input",htmlFor:"valueIp",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_FIELD_VALUE_IP"})}),n.a.createElement(K.a,{column:!0,unlimitedWidth:!0},n.a.createElement(v.Field,{full:!0,name:"valueIp",placeholder:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_FIELD_VALUE_IP_PLACEHOLDER"}))),a.mode===S.IpsSuppressionMode.NETWORK&&n.a.createElement(U.a,null,n.a.createElement(Se,{alignWith:"dropdown",htmlFor:"valueNetwork",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_FIELD_VALUE_NETWORK"})}),n.a.createElement(K.a,{column:!0,unlimitedWidth:!0},n.a.createElement(v.Field,{full:!0,name:"valueNetwork",options:d,type:"dropdown"}))),a.mode===S.IpsSuppressionMode.SUBNET&&n.a.createElement(U.a,null,n.a.createElement(Se,{alignWith:"input",htmlFor:"valueSubnet",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_FIELD_VALUE_SUBNET"})}),n.a.createElement(K.a,{column:!0,unlimitedWidth:!0},n.a.createElement(v.Field,{full:!0,name:"valueSubnet",placeholder:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_FIELD_VALUE_SUBNET_PLACEHOLDER"}))))))})};const Ie=Object(L.c)(U.a)`
  margin-bottom: 24px !important;
  padding-top: 32px;
`;var me=Object(l.f)(({intl:e,saveSuppression:t})=>{const a=Object(m.h)("security/threat-management/"+P.a.ALLOWLIST),r=Object(G.k)(),{inlineForm:T}=Object(G.m)(),_=T===P.a.ALLOWLIST,{values:c}=Object(M.e)(),s=Object(i.useSelector)(A.selectNetworksData),o=Object(E.useCallback)((e,t)=>{var a;return(e===S.IpsSuppressionMode.NETWORK?null===(a=s.find(({_id:e})=>e===t))||void 0===a?void 0:a.name:t)||""},[s]),N=Object(E.useMemo)(()=>[{compare:Object(H.b)(e)(({_:e,direction:t})=>Te(t)),id:"whitelist-direction",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_TABLE_DIRECTION"}),renderCell:({direction:e})=>n.a.createElement(l.c,{id:Te(e)}),minWidth:120,maxWidth:160},{compare:Object(H.a)(({mode:e})=>_e(e)),id:"whitelist-mode",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_TABLE_MODE"}),renderCell:({mode:e})=>n.a.createElement(l.c,{id:_e(e)}),minWidth:100,maxWidth:140},{compare:Object(H.a)(({mode:e,value:t})=>o(e,t)),id:"whitelist-allow",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_TABLE_ALLOW"}),renderCell:({mode:e,value:t})=>o(e,t),minWidth:100}],[o,e]),u=Object(E.useCallback)(()=>r.push(a),[r,a]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(f.a,{padding:"none"},n.a.createElement(Ie,null,n.a.createElement(y.a,{disableColumnFilters:!0,disableSelection:!0,disableTextPointer:!0,columns:N,items:c.ips.suppression.whitelist,onRowClick:e=>r.push(`${a}/${e.id}`)})),n.a.createElement(U.a,null,n.a.createElement(C.c,{legacy:!1,name:"internet-threat-management-advanced-whitelist-create",type:"button",variant:"inline",onClick:u},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_BUTTON_CREATE"})))),_&&n.a.createElement(Re,{saveSuppression:t}))});const pe=Object(L.c)(C.g)`
  margin-bottom: 32px;
`;var Oe=()=>{const{inlineForm:e}=Object(G.m)(),t=e===P.a.ALERTS,a=e===P.a.ALLOWLIST,{initialValues:r,resetForm:T,setValues:c,values:s}=Object(M.e)(),o=Object(i.useDispatch)(),N=Object(i.useSelector)(A.selectNetworksData),u=Object(E.useCallback)((e,t,a,E)=>{var n;const l=s,{suppression:i,...A}=r.ips,u=t.category?"alerts":"whitelist";let d;switch(e){case V.CREATE:d={...i,[u]:i[u].concat({id:_()(),...t})};break;case V.EDIT:d={...i,[u]:i[u].map(e=>e.id===t.id?t:e)};break;case V.REMOVE:d={...i,[u]:i[u].filter(({id:e})=>e!==t.id)};break;default:d=i}const R={...A,suppression:d};let m,O,b;if("alerts"===u){const{signature:a}=t;m=e===V.REMOVE?"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_TOAST_REMOVE_FAILURE":"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_FORM_TOAST_SAVE_FAILURE",O=e===V.REMOVE?"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_TOAST_REMOVE_SUCCESS":"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_FORM_TOAST_SAVE_SUCCESS",b={signature:a}}else{const{mode:a,value:E}=t;m=e===V.REMOVE?"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_TOAST_REMOVE_FAILURE":"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_TOAST_SAVE_FAILURE",O=e===V.REMOVE?"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_TOAST_REMOVE_SUCCESS":"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_FORM_TOAST_SAVE_SUCCESS",b={value:(a===S.IpsSuppressionMode.NETWORK?null===(n=N.find(({_id:e})=>e===E))||void 0===n?void 0:n.name:E)||""}}a(!0),o(h(R)).then(()=>{o(Object(I.c)({icon:p.a.success,message:O,values:b})),T({values:{...r,ips:{...R}}}),E&&E()}).catch(e=>{o(Object(I.c)({errorMessage:e.msg,errorValues:e,icon:p.a.danger,message:m,values:b})),a(!1)}).then(()=>c({...l,ips:{...l.ips,suppression:R.suppression}}))},[o,r,N,T,c,s]),d=Object(E.useMemo)(()=>[{id:"whitelist",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALLOW_LIST_TITLE"}),openByDefault:a,renderContent:()=>n.a.createElement(me,{saveSuppression:u})},{id:"alerts",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_ALERTS_TITLE"}),openByDefault:t,renderContent:()=>n.a.createElement(oe,{saveSuppression:u})}],[t,a,u]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(f.a,{padding:"none"},n.a.createElement(C.g,{flex:"none",flexWrap:"wrap"},n.a.createElement(pe,{flex:"1 0 368px"},n.a.createElement(D.SearchableGridLabel,{alignWith:"toggleSmall",description:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_RESTRICT_IP_ADDRESSES_DESCRIPTION"}),htmlFor:"ips.restrict_ip_addresses",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_RESTRICT_IP_ADDRESSES_LABEL"})}),n.a.createElement(C.g,{flex:"auto",alignItems:"flex-start"},n.a.createElement(v.Field,{name:"ips.restrict_ip_addresses",type:"checkbox"}))),n.a.createElement(pe,{flex:"1 0 368px"},n.a.createElement(D.SearchableGridLabel,{alignWith:"toggleSmall",description:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_RESTRICT_TOR_DESCRIPTION"}),htmlFor:"ips.restrict_tor",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ADVANCED_RESTRICT_TOR_LABEL"})}),n.a.createElement(C.g,{flex:"auto",alignItems:"flex-start"},n.a.createElement(v.Field,{name:"ips.restrict_tor",type:"checkbox"}))))),n.a.createElement(f.a,{padding:"none"},n.a.createElement(D.SearchableAccordion,{items:d,multiOpen:!0,variant:"secondary"})))},be=a(1850);const Le=Object(L.c)(g.a)`
  font-size: ${({theme:e})=>e.fontSize["font-size-l2"]} !important;
  color: ${({theme:e})=>e.motifPalette.text00};
`,Ge=({children:e,...t})=>n.a.createElement(Le,Object.assign({},t),e);var Me=a(2158);var ge,Ce=Object(l.f)(({intl:e})=>{const t=Object(G.k)(),a=Object(m.h)("security/threat-management/firewall/group/form"),r=Object(i.useSelector)(o.selectFirewallGroups),T=Object(E.useMemo)(()=>{const t=Object(H.b)(e);return[{compare:Object(H.a)(({name:e})=>e),id:"firewall-groups-name",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TABLE_NAME"}),renderCell:({name:e})=>e,sortable:!0,minWidth:100},{compare:t((e,{group_type:t})=>Object(Me.b)(t)),id:"firewall-groups-group_type",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TABLE_GROUP_TYPE"}),renderCell:({group_type:e})=>n.a.createElement(l.c,{id:Object(Me.b)(e)}),sortable:!0,minWidth:100},{compare:Object(H.a)(({group_members:e})=>e&&e.length||0),id:"firewall-groups-group_members",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TABLE_GROUP_MEMBERS"}),renderCell:({group_members:e})=>e&&e.length||0,sortable:!0,minWidth:100}]},[e]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(f.a,{padding:"none"},n.a.createElement(U.a,null,n.a.createElement(C.g,{alignItems:"center",flex:"1",justifyContent:"space-between"},n.a.createElement(Ge,{size:"body"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TITLE"})),n.a.createElement(C.b,null,n.a.createElement(C.c,{legacy:!1,name:"internet-threat-management-firewall-groups-create",type:"button",variant:"secondary",onClick:()=>t.push(a+"/new")},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_BUTTON_CREATE"}))))),(null==r?void 0:r.length)>0&&n.a.createElement(U.a,null,n.a.createElement(y.a,{columns:T,disableColumnFilters:!0,disableSelection:!0,disableTextPointer:!0,idField:"_id",items:r,onRowClick:({_id:e})=>t.push(`${a}/${e}`)}))),n.a.createElement(be.a,{marginBottom:"xxxxl",marginTop:"xxxxxl"}))}),De=a(1837),fe=a(2890);!function(e){e.ALL="ALL",e.GUEST="GUEST",e.GUESTV6="GUESTv6",e.LAN="LAN",e.LANV6="LANv6",e.WAN="WAN",e.WANV6="WANv6"}(ge||(ge={}));const ve=Object(L.c)(De.a)`
  > * {
    margin: 0 !important;
  }
`,he=Object(L.c)("div")`
  background: ${({theme:e})=>e.motifPalette.ui04};
  bottom: 0;
  flex: none;
  height: 1px;
  left: 0;
  position: absolute;
  width: 100%;
`;var Ve=()=>{const e=Object(G.k)(),t=Object(m.h)("security/threat-management/firewall/rule/form"),a=Object(i.useDispatch)(),r=Object(i.useSelector)(N.selectAllFirewallRules),T=Object(m.k)(e=>`\n      color: ${e.motifPalette.text01} !important;\n    `).replace(/^\./,""),[_,c]=Object(E.useState)(ge.WAN),[s,o]=Object(E.useState)(null),[A,u]=Object(E.useState)(null),S=Object(E.useMemo)(()=>[{id:"firewall-rules-rule_index",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TABLE_RULE_INDEX"}),renderCell:({rule_index:e})=>e},{id:"firewall-rules-enabled",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TABLE_ENABLED"}),renderCell:({enabled:e})=>e?n.a.createElement(B.v,{size:"small"}):null},{id:"firewall-rules-name",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TABLE_NAME"}),renderCell:({name:e})=>e},{id:"firewall-rules-action",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TABLE_ACTION"}),renderCell:({action:e})=>n.a.createElement(l.c,{id:Object(Me.c)(e)})},{id:"firewall-rules-protocol",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TABLE_PROTOCOL"}),renderCell:e=>Object(Me.a)(e)},{id:"firewall-rules-ruleset",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TABLE_RULESET"}),renderCell:({ruleset:e})=>n.a.createElement(l.c,{id:Object(Me.f)(e)})}],[]),d=Object(E.useMemo)(()=>[N.FirewallRuleRulesetV4.WAN_IN,N.FirewallRuleRulesetV4.WAN_OUT,N.FirewallRuleRulesetV4.WAN_LOCAL,N.FirewallRuleRulesetV4.LAN_IN,N.FirewallRuleRulesetV4.LAN_OUT,N.FirewallRuleRulesetV4.LAN_LOCAL,N.FirewallRuleRulesetV4.GUEST_IN,N.FirewallRuleRulesetV4.GUEST_OUT,N.FirewallRuleRulesetV4.GUEST_LOCAL,N.FirewallRuleRulesetV6.WANV6_IN,N.FirewallRuleRulesetV6.WANV6_OUT,N.FirewallRuleRulesetV6.WANV6_LOCAL,N.FirewallRuleRulesetV6.LANV6_IN,N.FirewallRuleRulesetV6.LANV6_OUT,N.FirewallRuleRulesetV6.LANV6_LOCAL,N.FirewallRuleRulesetV6.GUESTV6_IN,N.FirewallRuleRulesetV6.GUESTV6_OUT,N.FirewallRuleRulesetV6.GUESTV6_LOCAL].reduce((e,t)=>([1,2,3,4,5,6].forEach(a=>e.push({id:`${t}-${a}`})),e),[]),[]),R=Object(E.useMemo)(()=>r.filter(e=>{switch(_){case ge.ALL:return!0;case ge.GUEST:return e.ruleset===N.FirewallRuleRulesetV4.GUEST_IN||e.ruleset===N.FirewallRuleRulesetV4.GUEST_LOCAL||e.ruleset===N.FirewallRuleRulesetV4.GUEST_OUT;case ge.LAN:return e.ruleset===N.FirewallRuleRulesetV4.LAN_IN||e.ruleset===N.FirewallRuleRulesetV4.LAN_LOCAL||e.ruleset===N.FirewallRuleRulesetV4.LAN_OUT;case ge.WAN:return e.ruleset===N.FirewallRuleRulesetV4.WAN_IN||e.ruleset===N.FirewallRuleRulesetV4.WAN_LOCAL||e.ruleset===N.FirewallRuleRulesetV4.WAN_OUT;case ge.GUESTV6:return e.ruleset===N.FirewallRuleRulesetV6.GUESTV6_IN||e.ruleset===N.FirewallRuleRulesetV6.GUESTV6_LOCAL||e.ruleset===N.FirewallRuleRulesetV6.GUESTV6_OUT;case ge.LANV6:return e.ruleset===N.FirewallRuleRulesetV6.LANV6_IN||e.ruleset===N.FirewallRuleRulesetV6.LANV6_LOCAL||e.ruleset===N.FirewallRuleRulesetV6.LANV6_OUT;case ge.WANV6:return e.ruleset===N.FirewallRuleRulesetV6.WANV6_IN||e.ruleset===N.FirewallRuleRulesetV6.WANV6_LOCAL||e.ruleset===N.FirewallRuleRulesetV6.WANV6_OUT;default:return!1}}).map(e=>({dragAndDropGroupId:`${e.ruleset}-${Object(N.getRulePriority)(e)}`,id:`${e.ruleset}-${e.rule_index}`,isDragDisabled:Object(N.isFirewallRulePredefined)(e),...e})),[r,_]),I=Object(E.useMemo)(()=>[{id:ge.ALL,label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TAB_ALL"})},{id:ge.WAN,label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TAB_WAN"})},{id:ge.LAN,label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TAB_LAN"})},{id:ge.GUEST,label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TAB_GUEST"})},{id:ge.WANV6,label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TAB_WANV6"})},{id:ge.LANV6,label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TAB_LANV6"})},{id:ge.GUESTV6,label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TAB_GUESTV6"})}].map(e=>A?{...e,disabled:!0}:e),[A]),p=Object(E.useCallback)(e=>Object(N.isFirewallRulePredefined)(e)?void 0:T,[T]),O=Object(E.useCallback)(e=>{if(!e.destination)return;if(e.destination.droppableId===e.source.droppableId&&e.destination.index===e.source.index)return;const[t,E]=e.draggableId.split("-"),n=Object(N.getRulePriority)({rule_index:E}),l=R.findIndex(e=>e.ruleset===t&&Object(N.getRulePriority)(e)===n),i=l+e.destination.index,r=l+e.source.index,T=Math.min(i,r),_=Math.max(i,r)+1,c=R.slice(T,_),s=r-T,o=i-T,A=c[s];c.splice(s,1),c.splice(o,0,A);const S=Object(Me.g)(c),d=R.slice(0,T).concat(S).concat(R.slice(_));u(d),a(Object(N.reorderFirewallRules)({rules:S,ruleset:t})).finally(()=>u(null))},[a,R]),b=Object(E.useCallback)(({id:e})=>c(e),[c]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(f.a,{padding:"none"},n.a.createElement(U.a,null,n.a.createElement(C.g,{alignItems:"center",flex:"1",justifyContent:"space-between"},n.a.createElement(Ge,{size:"body"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TITLE"})),n.a.createElement(C.c,{legacy:!1,name:"internet-threat-management-firewall-rules-create",type:"button",variant:"secondary",onClick:()=>e.push(t+"/new")},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_BUTTON_CREATE"})))),n.a.createElement(U.a,null,n.a.createElement(ve,{tabs:I,selectedTab:_,onSelectTab:b}),n.a.createElement(he,null)),n.a.createElement(U.a,null,n.a.createElement(fe.a,{columns:S,disableColumnFilters:!0,disableSelection:!0,dragAndDropGroups:d,items:A||R,rowClassName:p,onDragEnd:O,onRowClick:a=>{Object(N.isFirewallRulePredefined)(a)||e.push(`${t}/${a._id}`)}}))),n.a.createElement(be.a,{marginBottom:"xxxxl",marginTop:"xxxxxl"}))};const Pe=Object(L.c)(C.g)`
  margin-bottom: 24px;
`,Fe=Object(L.c)(v.Field)`
  input {
    -moz-appearance: textfield;

    &::-webkit-inner-spin-button,
    &::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
  }

  + div > span {
    white-space: nowrap;
  }
`,Ue=Object(L.c)(g.a,{shouldForwardProp:e=>"width"!==e})`
  width: ${({width:e})=>e}px;
`,ye=Object(L.c)(Ge)`
  margin-top: 20px;
`,xe=Object(L.c)(g.a)`
  margin-left: 16px;
  margin-top: 12px;
`,je=Object(L.c)(Y.a,{shouldForwardProp:e=>"width"!==e})`
  flex: 0 0 ${({width:e})=>e}px !important;
`;var We=()=>{const e=Object(i.useSelector)(d.k);return n.a.createElement(f.a,{padding:"none"},n.a.createElement(U.a,null,n.a.createElement(ye,{size:"body"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_TITLE_CONNTRACK_MODULES"}),n.a.createElement("br",null),n.a.createElement(Ue,{width:330,size:"caption"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_TITLE_CONNTRACK_MODULES_DESC"})))),n.a.createElement(U.a,null,n.a.createElement(C.g,{flex:"0 0 100%",flexWrap:"wrap"},b.a.map(({label:e,property:t})=>n.a.createElement(Pe,{alignItems:"flex-start",flex:"0 0 128px",key:t},n.a.createElement(je,{alignWith:"toggleSmall",htmlFor:"usg."+t,label:n.a.createElement(g.a,{size:"caption"},n.a.createElement(l.c,{id:e})),width:52}),n.a.createElement(v.Field,{name:"usg."+t,type:"checkbox"}))))),n.a.createElement(U.a,null,n.a.createElement(Ge,{size:"body"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_TITLE_STATE_TIMEOUTS"}),n.a.createElement("br",null),n.a.createElement(Ue,{width:360,size:"caption"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_TITLE_STATE_TIMEOUTS_DESC"})))),n.a.createElement(U.a,null,n.a.createElement(Pe,{flex:"0 0 100%",flexWrap:"wrap"},b.d.map(({label:e,property:t})=>n.a.createElement(Pe,{alignItems:"flex-start",flex:"0 0 256px",key:t},n.a.createElement(je,{alignWith:"input",htmlFor:"usg."+t,label:n.a.createElement(g.a,{size:"caption"},n.a.createElement(l.c,{id:e})),width:107}),n.a.createElement(C.g,{flex:"none",flexDirection:"column",width:55},n.a.createElement(Fe,{fast:!0,full:!0,num:!0,name:"usg."+t,type:"number"})),n.a.createElement(xe,{size:"caption",color:"tertiary"},n.a.createElement(l.c,{id:"COMMON_UNIT_SECONDS"})))))),!e&&n.a.createElement(n.a.Fragment,null,n.a.createElement(U.a,null,n.a.createElement(Ge,{size:"body"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_TITLE_FIREWALL_OPTIONS"}))),n.a.createElement(U.a,null,n.a.createElement(Pe,{flex:"0 0 100%",flexWrap:"wrap"},b.c.map(({label:e,property:t})=>n.a.createElement(Pe,{alignItems:"flex-start",flex:"0 0 200px",key:t},n.a.createElement(je,{alignWith:"toggleSmall",htmlFor:"usg."+t,label:n.a.createElement(l.c,{id:e}),width:114}),n.a.createElement(v.Field,{name:"usg."+t,type:"checkbox"})))))),n.a.createElement(U.a,null,n.a.createElement(Ge,{size:"body"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_TITLE_DEFAULT_ACTION_LOGGING"}),n.a.createElement("br",null),n.a.createElement(Ue,{width:360,size:"caption"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_TITLE_DEFAULT_ACTION_LOGGING_DESC"})))),n.a.createElement(U.a,null,n.a.createElement(C.g,{flex:"0 0 100%",flexWrap:"wrap"},b.b.map(({label:e,property:t})=>n.a.createElement(Pe,{alignItems:"flex-start",flex:"0 0 200px",key:t},n.a.createElement(je,{alignWith:"toggleSmall",htmlFor:"usg."+t,label:n.a.createElement(g.a,{size:"caption"},n.a.createElement(l.c,{id:e})),width:95}),n.a.createElement(v.Field,{name:"usg."+t,type:"checkbox"}))))))};var we=()=>n.a.createElement(n.a.Fragment,null,n.a.createElement(Ve,null),n.a.createElement(Ce,null),n.a.createElement(We,null)),He=a(2901),ke=a(146),Be=a(159);const Ye=e=>["UDM","UGW3"].includes(e),Ke=(e,t)=>{const{enabled_categories:a,ips_mode:E}=e,n=Ye(t),l=!((null==a?void 0:a.length)||E&&E!==S.IpsMode.DISABLED),i=b.g.filter(({doesAccountToLimited:e})=>!n||e),r=(l?i.filter(({isDefault:e})=>e):(a||[]).map(e=>i.find(({value:t})=>t===e)).filter(Boolean)).reduce((e,{sensitivity:t})=>(e[t]+=1,e),{[P.c.ONE]:0,[P.c.TWO]:0,[P.c.THREE]:0,[P.c.FOUR]:0,[P.c.FIVE]:0}),T=i.reduce((e,{sensitivity:t})=>(e[t]+=1,e),{[P.c.ONE]:0,[P.c.TWO]:0,[P.c.THREE]:0,[P.c.FOUR]:0,[P.c.FIVE]:0});return[P.c.ONE,P.c.TWO,P.c.THREE,P.c.FOUR,P.c.FIVE].reduce((e,t)=>e.isPreviousSensitivitySatisfied&&r[t]===T[t]?{isPreviousSensitivitySatisfied:!0,result:t}:{...e,isPreviousSensitivitySatisfied:!1},{isPreviousSensitivitySatisfied:!0,result:null}).result||P.c.ONE},$e=Object(L.c)(v.Field)`
  align-items: flex-start;

  > :first-child {
    margin-right: 0 !important;
    margin-top: 2px;
  }

  > :last-child {
    padding-left: 12px;
  }
`,ze=Object(L.c)(U.a,{shouldForwardProp:e=>"marginBottom"!==e})`
  margin-bottom: ${({marginBottom:e})=>e}px !important;
`,qe=Object(L.c)(g.a)`
  line-height: 1.33333 !important;
`,Xe=Object(L.c)(g.a)`
  display: inline-block !important;
  margin-bottom: 4px;
`;var Je=()=>{const{initialValues:e,setFieldValue:t,values:a}=Object(M.e)(),r=Object(i.useSelector)(d.k),T=Object(i.useSelector)(c.selectSiteGatewayModel),_=Object(m.l)(),s=Object(E.useMemo)(()=>[{color:"blue",id:"1",label:"1",value:P.c.ONE,description:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_SENSITIVITY_LEVEL_ONE_DESCRIPTION"})},{color:"blue",id:"2",label:"2",value:P.c.TWO},{color:"blue",id:"3",label:"3",value:P.c.THREE,description:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_SENSITIVITY_LEVEL_THREE_DESCRIPTION"})},{color:"blue",id:"4",label:"4",value:P.c.FOUR},{color:"blue",id:"5",label:"5",value:P.c.FIVE,description:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_SENSITIVITY_LEVEL_FIVE_DESCRIPTION"})}],[]),o=Object(E.useCallback)(e=>{const a=e.currentTarget.value,E=Ye(T);t("ips.enabled_categories",b.g.filter(({doesAccountToLimited:e,sensitivity:t})=>(!E||e)&&Number(t)<=Number(a)).map(({value:e})=>e)),t("ips.sensitivity",a)},[t,T]);Object(E.useEffect)(()=>{var E,n;const l=!(null===(E=e.ips.enabled_categories)||void 0===E?void 0:E.length)&&!e.ips.isIpsEnabled&&!(null===(n=a.ips.enabled_categories)||void 0===n?void 0:n.length)&&a.ips.isIpsEnabled,i=Ye(T);l&&t("ips.enabled_categories",b.g.filter(({doesAccountToLimited:e,isDefault:t})=>(!i||e)&&t).map(({value:e})=>e))},[a.ips.isIpsEnabled]);const N=!a.ips.isIpsEnabled;return n.a.createElement(f.a,null,n.a.createElement(ze,{marginBottom:56},n.a.createElement(D.SearchableGridLabel,{alignWith:"toggleSmall",description:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_ENABLED_DESCRIPTION"}),htmlFor:"ips.isIpsEnabled",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_ENABLED_LABEL"}),searchText:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_ENABLED_SEARCH_TEXT"}),n.a.createElement(K.a,null,n.a.createElement(v.Field,{name:"ips.isIpsEnabled",type:"checkbox"}))),n.a.createElement(ze,{disabled:N,marginBottom:24},n.a.createElement(C.g,{flex:"0 1 512px"},n.a.createElement(C.g,{flex:"none"},n.a.createElement(B.e,{color:_.motifPalette.warning})),n.a.createElement(C.g,{flex:"0 0 12px"}),n.a.createElement(C.g,{flex:"1"},n.a.createElement(qe,{color:"tertiary"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_WARNING",values:{disableHardwareOffload:!r,udmIpsThroughput:ke.deviceModels.UDM.details.ipsThroughput,udmproIpsThroughput:ke.deviceModels.UDMPRO.details.ipsThroughput,ugw3IpsThroughput:ke.deviceModels.UGW3.details.ipsThroughput,ugw4IpsThroughput:ke.deviceModels.UGW4.details.ipsThroughput}}))))),n.a.createElement(ze,{disabled:N,marginBottom:56},n.a.createElement(C.g,{flex:"0 1 512px"},n.a.createElement(C.g,{flex:"none"},n.a.createElement(B.cb,{color:_.motifPalette.info})),n.a.createElement(C.g,{flex:"0 0 12px"}),n.a.createElement(C.g,{flex:"1"},n.a.createElement(qe,{color:"tertiary"},n.a.createElement(l.b,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_INFO",values:{link:Be.a.privacyUrl,linkText:Be.a.privacyUrl.replace(/^(https?:\/\/)?(www\.)?/,"")}}))))),n.a.createElement(ze,{disabled:N,marginBottom:52},n.a.createElement(C.g,{flex:"1",flexWrap:"wrap"},n.a.createElement(C.g,{flex:"0 0 240px"},n.a.createElement($e,{disabled:N,name:"ips.ips_mode",type:"radio",value:S.IpsMode.IDS},n.a.createElement(Xe,{color:"primary"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_MODE_IDS_LABEL"})),n.a.createElement(qe,{color:"tertiary"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_MODE_IDS_DESCRIPTION"})))),n.a.createElement(C.g,{flex:"0 0 40px"}),n.a.createElement(C.g,{flex:"0 0 240px"},n.a.createElement($e,{disabled:N,name:"ips.ips_mode",type:"radio",value:S.IpsMode.IPS},n.a.createElement(Xe,{color:"primary"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_MODE_IPS_LABEL"})),n.a.createElement(qe,{color:"tertiary"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_MODE_IPS_DESCRIPTION"})))),r&&n.a.createElement(C.f,{hidden:!0},n.a.createElement(C.g,{flex:"0 0 40px"}),n.a.createElement(C.g,{flex:"0 0 240px"},n.a.createElement($e,{disabled:N,name:"ips.ips_mode",type:"radio",value:S.IpsMode.IPS_INLINE},n.a.createElement(Xe,{color:"primary"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_MODE_IPS_INLINE_LABEL"})),n.a.createElement(qe,{color:"tertiary"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_MODE_IPS_INLINE_DESCRIPTION"}))))))),n.a.createElement(ze,{disabled:N,marginBottom:28},n.a.createElement(D.SearchableGridLabel,{alignWith:12,description:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_SENSITIVITY_DESCRIPTION_"+a.ips.sensitivity}),htmlFor:"sensitivity",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_SENSITIVITY_LABEL"}),searchText:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_SENSITIVITY_SEARCH_TEXT"}),n.a.createElement(K.a,null,n.a.createElement(He.a,{items:s,labelPills:!0,name:"sensitivity",value:a.ips.sensitivity,onChange:o,continuous:!0}))))};const Qe=Object(L.c)(U.a)`
  flex-wrap: wrap !important;
`,Ze=Object(L.c)(C.g,{shouldForwardProp:e=>"hasDescription"!==e})`
  align-items: ${({hasDescription:e})=>e?"flex-start":"center"};
`,et=Object(L.c)(C.g)`
  &:not(:last-child) {
    margin-bottom: 32px;
  }

  &:last-child {
    margin-bottom: 24px;
  }
`,tt=Object(L.c)(g.a)`
  border-bottom: 1px solid ${({theme:e})=>e.motifPalette.ui04};
  display: block !important;
  font-size: ${({theme:e})=>e.fontSize["font-size-l2"]} !important;
  margin-top: 8px;
  margin-bottom: 16px;
  padding-bottom: 12px;
  width: 100%;
`;var at=()=>{const{setFieldValue:e,values:t}=Object(M.e)(),a=Object(i.useSelector)(c.selectSiteGatewayModel);return n.a.createElement(f.a,{padding:"none"},Object.entries(b.f).map(([i,{label:r}])=>{const T=b.g.filter(({doesAccountToLimited:e,group:t})=>(!Ye(a)||e)&&t===i);return T.length>0&&n.a.createElement(E.Fragment,{key:i},n.a.createElement(U.a,null,n.a.createElement(tt,{size:"body",color:"primary",weight:"bold"},n.a.createElement(l.c,{id:r}))),n.a.createElement(Qe,null,T.map(({label:E,value:i,description:r})=>{var T;return n.a.createElement(et,{flex:"0 1 368px",key:i},n.a.createElement(Y.a,{alignWith:"toggleSmall",htmlFor:"enabled_categories-"+i,label:n.a.createElement(l.c,{id:E}),description:r?n.a.createElement(l.c,{id:r}):""}),n.a.createElement(Ze,{flex:"0 1 112px",hasDescription:!!r},n.a.createElement(v.Field,{field:{name:"enabled_categories-"+i,value:null===(T=t.ips.enabled_categories)||void 0===T?void 0:T.includes(i),onChange:E=>{const n=E.currentTarget.checked?t.ips.enabled_categories.concat(i):t.ips.enabled_categories.filter(e=>e!==i);e("ips.enabled_categories",n),e("ips.sensitivity",Ke({...t.ips,enabled_categories:n},a))}},name:"enabled_categories-"+i,type:"checkbox"})))})))}))},Et=a(1197),nt=a(1954),lt=a(3);const it=Object(lt.a)(A.selectCorporateAndGuestNetworks,S.selectIpsSettings,(e,t)=>{const a=(t.honeypot||[]).map(({network_id:e})=>e);return e.filter(({_id:e})=>!a.includes(e))});var rt,Tt,_t=a(93);!function(e){e.BROADCAST="broadcast",e.GATEWAY="gateway",e.NETWORK="network"}(rt||(rt={})),function(e){e.CREATE="create",e.EDIT="edit",e.REMOVE="remove"}(Tt||(Tt={}));const ct=e=>{if(!e)return{ip:"",version:"v4"};const t=Object(_t.subnet)(e),a=Object(_t.fromLong)(Object(_t.toLong)(t.firstHost())+1);return{ip:a,version:Object(_t.isValidIpv6)(a)?"v6":"v4"}},st=e=>{const t=t=>function(a){if(Object(_t.isValidIpv4)(a)){const{network_id:E}=this.parent,n=e.find(({_id:e})=>E===e),l=(null==n?void 0:n.ip_subnet)&&Object(_t.subnet)(n.ip_subnet);if(!l)return!1;switch(t){case rt.BROADCAST:return a!==l.broadcastAddress();case rt.GATEWAY:return a!==l.firstHost();case rt.NETWORK:return a!==l.networkAddress();default:return!1}}return!1};return q.a.object().shape({ip_address:q.a.string().label("SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_FORM_IP_ADDRESS_LABEL").matches($.h,n.a.createElement(l.c,{id:"COMMON_VALIDATION_VALID_IPV4"})).test("isInSubnet",n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_FORM_IP_ADDRESS_VALIDATION_SUBNET"}),(function(t){if(Object(_t.isValidIpv4)(t)){const{network_id:a}=this.parent,E=e.find(({_id:e})=>a===e);return!E||Object(_t.subnet)(E.ip_subnet).contains(t)}return!1})).test("notWithinDhcpRange",n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_FORM_IP_ADDRESS_VALIDATION_DHCP"}),(function(t){if(Object(_t.isValidIpv4)(t)){const{network_id:a}=this.parent,E=e.find(({_id:e})=>a===e);return!E||Object(_t.toLong)(t)<Object(_t.toLong)(E.dhcpd_start)||Object(_t.toLong)(t)>Object(_t.toLong)(E.dhcpd_stop)}return!1})).test("notBroadcastAddress",n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_FORM_IP_ADDRESS_VALIDATION_RESERVED",values:{ipAddressReservation:rt.BROADCAST}}),t(rt.BROADCAST)).test("notGatewayAddress",n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_FORM_IP_ADDRESS_VALIDATION_RESERVED",values:{ipAddressReservation:rt.GATEWAY}}),t(rt.GATEWAY)).test("notNetworkAddress",n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_FORM_IP_ADDRESS_VALIDATION_RESERVED",values:{ipAddressReservation:rt.NETWORK}}),t(rt.NETWORK)).required(),network_id:q.a.string().label("SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_FORM_NETWORK_ID_LABEL").required(),version:q.a.string().oneOf(["v4","v6"]).required()})};var ot=a(52);const Nt=Object(L.c)("button")`
  border: 0;
  flex: none;
  height: 0;
  margin: 0;
  outline: none;
  padding: 0;
  overflow: hidden;
  visibility: hidden;
  width: 0;
`,At=Object(L.c)(ot.a,{shouldForwardProp:e=>"isEdit"!==e})`
  ${({isEdit:e})=>e&&"& > footer > div {\n      width: 100%;\n\n      & > div:first-child {\n        margin-right: auto;\n      }\n    }"}
`,ut=({dirty:e,handleSubmit:t,isSubmitting:a,isValid:r,setSubmitting:T,setValues:_,values:c,onClose:s,onSubmit:o,honeypot:N,saveHoneypot:u})=>{const S=Object(i.useSelector)(A.selectCorporateAndGuestNetworks),d=Object(i.useSelector)(it),R=Object(E.useMemo)(()=>{if(N){const e=S.find(({_id:e})=>e===(null==N?void 0:N.network_id));return[{label:`${null==e?void 0:e.name} - ${null==e?void 0:e.ip_subnet}`,value:null==e?void 0:e._id}]}return d.map(({_id:e,ip_subnet:t,name:a})=>({label:`${a} - ${t}`,value:e}))},[S,N,d]);return Object(E.useEffect)(()=>{if(e){const e=S.find(({_id:e})=>e===c.network_id),t=ct(null==e?void 0:e.ip_subnet);_({...c,ip_address:t.ip,version:t.version})}},[c.network_id]),n.a.createElement(At,{actions:[!!N&&{disabled:a,text:n.a.createElement(l.c,{id:"COMMON_ACTION_REMOVE"}),type:"button",variant:"default",onClick:()=>u(Tt.REMOVE,N,T,s)},{disabled:a,text:n.a.createElement(l.c,{id:"COMMON_ACTION_CANCEL"}),type:"button",variant:"default",onClick:s},{disabled:a||!r,text:n.a.createElement(l.c,{id:N?"COMMON_ACTION_SAVE":"COMMON_ACTION_CREATE"}),type:"button",variant:"primary",onClick:()=>o(c,{setSubmitting:T})}],title:n.a.createElement(l.c,{id:N?"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_FORM_TITLE_EDIT":"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_FORM_TITLE_CREATE"}),size:"small",onRequestClose:s,isEdit:!!N},n.a.createElement("form",{onKeyDown:e=>{"Enter"===e.key&&!a&&r&&o(c,{setSubmitting:T})},onSubmit:t},n.a.createElement(f.a,null,n.a.createElement(U.a,null,n.a.createElement(v.Field,{disabled:!!N,full:!0,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_FORM_NETWORK_ID_LABEL",name:"network_id",options:R,translateLabel:!0,type:"dropdown"})),n.a.createElement(U.a,null,n.a.createElement(K.a,{column:!0},n.a.createElement(v.Field,{full:!0,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_FORM_IP_ADDRESS_LABEL",name:"ip_address"})))),n.a.createElement(Nt,{disabled:a||!r,type:"submit"})))};var St=({saveHoneypot:e,onClose:t,networkId:a})=>{const l=(Object(M.e)().values.ips.honeypot||[]).find(({network_id:e})=>e===a),r=Object(i.useSelector)(A.selectCorporateAndGuestNetworks),T=Object(i.useSelector)(it),_=Object(E.useMemo)(()=>{if(l)return l;const e=T[0],t=ct(null==e?void 0:e.ip_subnet);return{ip_address:t.ip,network_id:null==e?void 0:e._id,version:t.version}},[l,T]),c=Object(E.useMemo)(()=>st(r),[r]),s=Object(E.useCallback)((a,{setSubmitting:E})=>e(l?Tt.EDIT:Tt.CREATE,a,E,t),[l,e,t]);return n.a.createElement(M.c,{initialValues:_,validationSchema:c,onSubmit:s},a=>n.a.createElement(ut,Object.assign({},a,{honeypot:l,onClose:t,onSubmit:s,saveHoneypot:e})))};const dt=Object(L.c)(C.g)`
  > :not(:first-child) {
    margin-left: 8px;
  }
`,Rt=Object(L.c)(C.g)`
  margin-top: 18px;
`,It=Object(L.c)("div")`
  margin-top: 22px;
  max-height: 223px; // 223px is the exact table wrapper maximum height according to the design as of 2020-05-07
  overflow-x: visible;
  overflow-y: auto;
  width: 100%;
`;var mt=()=>{var e;const{initialValues:t,resetForm:a,setValues:r,values:T}=Object(M.e)(),_=Object(i.useDispatch)(),c=Object(i.useSelector)(A.selectCorporateAndGuestNetworks),s=Object(E.useContext)(C.l),o=Object(i.useSelector)(it),[N,u]=Object(E.useState)(!1),[S,d]=Object(E.useState)(null),R=Object(E.useMemo)(()=>[{id:"honeypot-table-name",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_TABLE_NAME"}),renderCell:({network_id:e})=>{var t,a;return null!==(a=null===(t=c.find(({_id:t})=>t===e))||void 0===t?void 0:t.name)&&void 0!==a?a:"-"}},{id:"honeypot-table-subnet",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_TABLE_SUBNET"}),renderCell:({network_id:e})=>{var t,a;return null!==(a=null===(t=c.find(({_id:t})=>t===e))||void 0===t?void 0:t.ip_subnet)&&void 0!==a?a:"-"}},{id:"honeypot-table-ip-address",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_TABLE_IP_ADDRESS"}),renderCell:({ip_address:e})=>e||"-"}],[c]),m=Object(E.useMemo)(()=>T.ips.honeypot?T.ips.honeypot.map(({network_id:e})=>e).sort().join(""):"empty",[T.ips.honeypot]),O=Object(E.useCallback)((e,E,i,s)=>{var o;const N=T,{honeypot:A,...u}=t.ips,S=(null===(o=c.find(({_id:e})=>e===E.network_id))||void 0===o?void 0:o.name)||n.a.createElement(l.c,{id:"COMMON_UNKNOWN"});let d;switch(e){case Tt.CREATE:d=(A||[]).concat(E);break;case Tt.EDIT:d=(A||[]).map(e=>e.network_id===E.network_id?E:e);break;case Tt.REMOVE:d=(A||[]).filter(({network_id:e})=>e!==E.network_id);break;default:d=A}const R={...u,honeypot:d,honeypot_enabled:!0};i(!0);const m=e===Tt.REMOVE;_(h(R)).then(()=>{_(Object(I.c)({icon:p.a.success,message:m?"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_TOAST_REMOVE_SUCCESS":"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_FORM_TOAST_SAVING_SUCCESS",values:{networkName:S}})),a({values:{...t,ips:{...R}}}),s&&s()}).catch(e=>{_(Object(I.c)({errorMessage:e.msg,errorValues:e,icon:p.a.danger,message:m?"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_TOAST_REMOVE_FAILURE":"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_FORM_TOAST_SAVING_FAILURE",values:{networkName:S}})),i(!1)}).then(()=>r({...N,ips:{...N.ips,honeypot:R.honeypot,honeypot_enabled:R.honeypot_enabled}}))},[c,_,t,a,r,T]),b=Object(E.useCallback)(()=>{o.length>0&&u(!0)},[o,u]),L=Object(E.useCallback)(()=>{u(!1),d(null)},[d,u]),G=n.a.createElement(C.c,{disabled:!o.length,legacy:!1,name:"internet-threat-management-network-scanners-honeypot-create",type:"button",variant:"inline",onClick:b},n.a.createElement(dt,{alignItems:"center"},n.a.createElement(B.ub,null),n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_CREATE_BUTTON"})));return n.a.createElement(n.a.Fragment,null,n.a.createElement(f.a,{padding:"none"},n.a.createElement(U.a,null,n.a.createElement(C.g,{alignSelf:"flex-start",flex:"1"},n.a.createElement(D.SearchableGridLabel,{alignWith:"toggleSmall",description:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_ENDPOINT_SCANNING_DESCRIPTION"}),htmlFor:"ips.endpoint_scanning",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_ENDPOINT_SCANNING_LABEL"}),searchTags:["ENDPOINT_SCANNER","PORT_SCANNER","nmap"],searchText:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_ENDPOINT_SCANNING_SEARCH_TEXT"}),n.a.createElement(C.g,{alignItems:"flex-start",flex:"0 1 112px"},n.a.createElement(v.Field,{name:"ips.endpoint_scanning",type:"checkbox"}))),n.a.createElement(C.g,{flex:"1",flexDirection:"column"},n.a.createElement(C.g,{flex:"auto",width:"100%"},n.a.createElement(D.SearchableGridLabel,{alignWith:"toggleSmall",description:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_ENABLED_DESCRIPTION"}),htmlFor:"ips.honeypot_enabled",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_ENABLED_LABEL"}),searchText:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_ENABLED_SEARCH_TEXT"}),n.a.createElement(C.g,{alignItems:"flex-start",flex:"0 1 112px"},n.a.createElement(v.Field,{name:"ips.honeypot_enabled",type:"checkbox"}))),!s&&T.ips.honeypot_enabled&&n.a.createElement(Rt,{flex:"auto",width:"100%"},o.length?G:n.a.createElement(Et.a,{message:n.a.createElement(g.a,null,n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_NETWORK_SCANNERS_HONEYPOT_CREATE_BUTTON_TOOLTIP"})),width:200},G)),n.a.createElement(nt.a,{in:T.ips.honeypot_enabled&&(null===(e=T.ips.honeypot)||void 0===e?void 0:e.length)>0},n.a.createElement(It,null,n.a.createElement(y.a,{columns:R,disableColumnFilters:!0,disableSelection:!0,disableTextPointer:!0,disableSort:!0,idField:"network_id",items:T.ips.honeypot,key:m,onRowClick:({network_id:e})=>{d(e),u(!0)}})))))),N&&n.a.createElement(St,{networkId:S,saveHoneypot:O,onClose:L}))};const pt=Object(L.c)(D.SearchableAccordion)`
  // expands accordion text container to maximum width to hold the status bar for Customize Threat Management panel
  li > :first-child > :first-child {
    width: 100%;
  }
`,Ot=Object(L.c)(g.a)`
  display: block !important;
  margin-left: ${({theme:e})=>e.spacing["spacing-s"]};
`;var bt=({formValues:e})=>{const{inlineForm:t}=Object(G.m)(),a=t===P.a.ALERTS,r=t===P.a.ALLOWLIST,{resetForm:T,status:_,values:s}=Object(M.e)(),o=Object(i.useSelector)(c.selectIsNetworkScannersSupportedByGateway),N=Object(i.useSelector)(c.selectSiteGatewayModel),A=Object(i.useSelector)(c.selectSiteGatewayMac),u=Ye(N),S=Object(E.useMemo)(()=>b.g.filter(({doesAccountToLimited:e})=>!u||e),[u]),d=Object(E.useMemo)(()=>{var e;return[{id:"ips-customization",label:n.a.createElement(C.g,{alignItems:"center",flex:"1"},n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ACCORDION_IPS_CUSTOMIZATION"}),n.a.createElement(Ot,{color:"tertiary"},"(",n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ACCORDION_IPS_CUSTOMIZATION_COUNTER",values:{enabled:(null===(e=s.ips.enabled_categories)||void 0===e?void 0:e.length)||0,total:S.length}}),")")),description:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ACCORDION_IPS_CUSTOMIZATION_DESCRIPTION"}),renderContent:()=>n.a.createElement(at,null)},o?{id:"network-scanners",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ACCORDION_NETWORK_SCANNERS"}),renderContent:()=>n.a.createElement(mt,null)}:void 0,{id:"firewall",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ACCORDION_FIREWALL"}),renderContent:()=>n.a.createElement(we,null)},{id:"advanced",label:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_ACCORDION_ADVANCED"}),openByDefault:a||r,renderContent:()=>n.a.createElement(Oe,null)}].filter(e=>!!e)},[a,o,r,S.length,s.ips.enabled_categories]);return Object(E.useEffect)(()=>{_.isSubmitted&&T({values:e})},[e,T,_.isSubmitted]),Object(m.e)(A?[Object(c.fetchDeviceCfg)(A)]:[],n.a.createElement(n.a.Fragment,null,n.a.createElement(Je,null),n.a.createElement(pt,{items:d,multiOpen:!0,variant:"primary"})))};t.default=()=>{const e=Object(i.useDispatch)(),t=Object(i.useSelector)(S.selectIpsSettings),a=Object(i.useSelector)(u.u),T=Object(i.useSelector)(d.k),L=Object(i.useSelector)(c.selectHasSiteUxg),G=Object(i.useSelector)(c.selectSiteGatewayModel),M=Object(i.useSelector)(S.selectUsgSettings),g=Object(m.g)(),C=Object(E.useMemo)(()=>({isSubmitted:!1}),[]),D=Object(E.useMemo)(()=>{var e,a;return{ips:{...t,ips_mode:t.ips_mode&&t.ips_mode!==S.IpsMode.DISABLED?t.ips_mode:S.IpsMode.IDS,isIpsEnabled:!!t.ips_mode&&t.ips_mode!==S.IpsMode.DISABLED,sensitivity:Ke(t,G),suppression:{...null==t?void 0:t.suppression,alerts:(null===(e=null==t?void 0:t.suppression)||void 0===e?void 0:e.alerts)||[],whitelist:((null===(a=null==t?void 0:t.suppression)||void 0===a?void 0:a.whitelist)||[]).map(e=>({...e,id:_()()}))}},usg:{...[...b.a,...b.b,...T||L?[]:b.c,...b.d].reduce((e,{defaultValue:t,property:a})=>(e[a]=t,e),{}),...M}}},[t,T,L,G,M]),f=Object(E.useMemo)(()=>({component:n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_TITLE"}),message:"internet-threat-management"}),[]),v=Object(E.useCallback)((t,{setStatus:a,setSubmitting:E})=>{const{ips:n,usg:l}=t,i=[];Object(r.a)(n,D.ips)||i.push(e(h({...n}))),Object(r.a)(l,D.usg)||i.push(e(Object(S.saveSettings)({...l}))),Promise.all(i).then(()=>{e(Object(I.c)({icon:p.a.success,message:"SETTINGS_INTERNET_THREAT_MANAGEMENT_TOAST_SAVE_SUCCESS"})),a({isSubmitted:!0})}).catch(t=>{e(Object(I.c)({errorMessage:t.msg,errorValues:t,icon:p.a.danger,message:"SETTINGS_INTERNET_THREAT_MANAGEMENT_TOAST_SAVE_ERROR"})),E(!1)})},[e,D]);return Object(m.e)([Object(c.fetchSiteGateway)({type:O.a.CACHE}),Object(s.fetchDevicesBasic)(void 0,{type:O.a.CACHE}),Object(o.fetchFirewallGroups)(void 0,{crudCacheStrategy:{type:O.a.CACHE}}),Object(N.fetchFirewallRules)(void 0,{crudCacheStrategy:{type:O.a.CACHE}}),Object(A.fetchNetworks)(void 0,{crudCacheStrategy:{type:O.a.CACHE}}),Object(S.fetchSettings)({type:O.a.CACHE})],n.a.createElement(R.b,{goBack:g,initialStatus:C,initialValues:D,isEdit:!0,isView:a,showBack:!0,title:f,unsavedChangesModalIgnoredPaths:/\/(alerts|allowlist)((\/)|(\/[\w_-]+\/?))?$/,validationSchema:b.h,onEscClicked:g,onSubmit:v},n.a.createElement(bt,{formValues:D})))}},1939:function(e,t,a){"use strict";var E=a(0),n=a(31);t.a=()=>{const e=Object(n.l)(),[t]=Object(E.useState)(e.pathname),[a,l]=Object(E.useState)(!1),i=Object(E.useRef)();return Object(E.useEffect)(()=>{l(!1);const a=/^(.*)\/[a-z0-9]*/i.exec(t),E=/^(.*)\/[a-z0-9]*/i.exec(e.pathname);return a[0].length===E[0].length&&a[1]===E[1]&&(i.current=setTimeout(()=>l(!0),500)),()=>clearTimeout(i.current)},[e.pathname,t]),a}},1945:function(e,t,a){"use strict";a.d(t,"b",(function(){return U})),a.d(t,"a",(function(){return D}));var E=a(0),n=a.n(E),l=a(5),i=a(4),r=a(45),T=a(1973),_=a(1974),c=a(1948),s=a(799),o=a(95),N=a(1952),A=a(23),u=a(49),S=a(40),d=a(1848),R=a(793),I=a(1939);const m=l.a`
  &-appear,
  &-enter {
    opacity: 0;
    transform: translateX(15px);
  }
  &-appear-active,
  &-enter-active,
  &-appear-done,
  &-enter-done {
    opacity: 1;
    transform: translateX(0);
    transition: opacity 150ms cubic-bezier(0.25, 0.1, 0.25, 1) 130ms,
      transform 300ms cubic-bezier(0.25, 0.1, 0.25, 1.4) 130ms;
  }
  &-exit {
    opacity: 1;
    transform: translateX(0);
  }
  &-exit-active,
  &-exit-done {
    opacity: 0;
    transform: translateX(15px);
    transition: opacity 100ms linear, transform 100ms linear;
  }
`;var p=({timeout:e={enter:300,exit:100},in:t,children:a,ignoredPaths:l,...i})=>{const r=Object(I.a)(),T=Object(R.a)(l),_=Object(E.useMemo)(()=>n.a.Children.map(a,a=>null===a?a:n.a.createElement(d.a,Object.assign({appear:t||!T||r,in:t||!T||r,timeout:e,classNames:m,mountOnEnter:!0},i),a)),[a,t,T,r,e,i]);return n.a.createElement(n.a.Fragment,null,_)};const O=l.a`
  &-appear,
  &-enter {
    border-bottom: transparent !important;
  }
  &-appear-active,
  &-enter-active,
  &-appear-done,
  &-enter-done {
    transition: border-bottom 150ms cubic-bezier(0.25, 0.1, 0.25, 1);
  }
  &-exit {
    opacity: 1;
  }
  &-exit-active,
  &-exit-done {
    opacity: 0;
    transition: opacity 100ms linear;
  }
`;var b=({timeout:e={enter:150,exit:100},in:t,children:a,ignoredPaths:l,...i})=>{const r=Object(I.a)(),T=Object(R.a)(l),_=Object(E.useMemo)(()=>n.a.Children.map(a,a=>null===a?a:n.a.createElement(d.a,Object.assign({appear:t||!T||r,in:t||!T||r,timeout:e,classNames:O,mountOnEnter:!0},i),a)),[a,t,T,r,e,i]);return n.a.createElement(n.a.Fragment,null,_)};const L=Object(l.c)(o.g)`
  > * {
    /* Use margin on child rather than padding on self not to occupy space when no button is shown */
    margin-left: ${({theme:e})=>e.spacing["spacing-xxl"]};
    margin-right: ${({theme:e})=>e.spacing["spacing-xxl"]};
  }
`,G=Object(l.c)(o.g)`
  border-bottom: 1px solid ${({theme:e})=>e.motifPalette.ui03};
`,M=Object(l.c)("h1")`
  font-size: 16px;
  font-weight: normal;
`,g=Object(l.c)(o.c)`
  padding: ${({theme:e})=>e.spacing["spacing-s"]};
`,C=Object(l.c)(u.a)`
  color: ${({theme:e})=>e.motifPalette.text01} !important;
  font-size: 16px !important;
`;var D=({title:e,showBack:t,goBack:a,onEscClicked:E,hideClose:l,ignoredPaths:i})=>{const{motif:r}=Object(S.a)();return n.a.createElement(b,{ignoredPaths:i},n.a.createElement(G,{flex:"none",height:"65px"},n.a.createElement(p,{ignoredPaths:i},n.a.createElement(o.g,{alignItems:"center",flex:"1",justifyContent:"space-between"},n.a.createElement(L,{alignItems:"center",flex:"1",height:"100%"},t&&n.a.createElement(g,{legacy:!1,name:"backButton",type:"button",onClick:a,motif:r},n.a.createElement(A.g,null))),n.a.createElement(M,null,n.a.createElement(C,{weight:"bold"},e.component)),n.a.createElement(L,{alignItems:"center",flex:"1",height:"100%",justifyContent:"flex-end"},!l&&n.a.createElement(g,{legacy:!1,name:"closeButton",type:"button",onClick:E},n.a.createElement(A.A,null)))))))};const f=Object(l.c)(o.g)`
  width: 100%;
  max-width: ${s.a};
  margin: 0 auto;
  padding: ${({theme:e})=>e.spacing["spacing-xxxxl"]}
    ${({theme:e})=>2*parseInt(e.spacing["spacing-xxxxl"],10)}px;
`,v=Object(l.c)("form")`
  display: flex;
  flex: 1;
  overflow: hidden;
  width: 100%;
  height: 100%;
`,h=Object(l.c)(o.g)`
  @media (max-width: 1010px) {
    flex-direction: column;
  }
`,V=Object(l.c)(T.a)`
  > :first-child {
    max-width: ${s.a};
    padding-left: ${({theme:e})=>2*parseInt(e.spacing["spacing-xxxxl"],10)}px !important;
    padding-right: ${({theme:e})=>2*parseInt(e.spacing["spacing-xxxxl"],10)}px !important;
    position: relative;
    margin: 0 auto;
  }
`,P=Object(l.c)(o.h)`
  background: transparent;
  overflow: scroll !important;
  margin-right: -${({theme:e})=>e.scrollBarWidth}px;
`,F=Object(l.c)(o.k)`
  height: 100%;
  width: 100%;
`;var U=({children:e,disableUnsavedChangesModal:t,goBack:a,hideClose:E,isEdit:l,isView:T,showBack:s,title:A,unsavedChangesModalIgnoredPaths:u,onEscClicked:S,submitText:d="COMMON_ACTION_APPLY_CHANGES",footerActiveOverride:R=!1,customFooterButtons:I,...m})=>n.a.createElement(r.c,Object.assign({enableReinitialize:!0},m),({dirty:l,handleReset:r,handleSubmit:m,isSubmitting:p})=>n.a.createElement(v,{autoComplete:"off",onSubmit:m},n.a.createElement(F,{vertical:!0},n.a.createElement(D,{goBack:a,hideClose:E,showBack:s,title:A,onEscClicked:S,ignoredPaths:u}),n.a.createElement(N.a,{ignoredPaths:u},n.a.createElement(P,{flex:"1"},n.a.createElement(f,{flex:"none",flexDirection:"column"},e))),!t&&!T&&n.a.createElement(c.a,{ignoredPaths:u,when:l&&!p}),(!T||R)&&n.a.createElement(V,{active:l||R},n.a.createElement(o.g,{justifyContent:I?"space-between":"flex-end",width:"100%",alignItems:"center"},I&&n.a.createElement(h,null,I(p)),!T&&n.a.createElement(o.g,null,n.a.createElement(_.a,{disabled:!l||p,type:"button",variant:"default",onClick:r},n.a.createElement(i.c,{id:"COMMON_ACTION_CANCEL"})),n.a.createElement(_.a,{disabled:!l||p,type:"submit",variant:"primary"},n.a.createElement(i.c,{id:d}))))))))},1946:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return l})),a.d(t,"m",(function(){return o})),a.d(t,"k",(function(){return N})),a.d(t,"h",(function(){return A})),a.d(t,"g",(function(){return u})),a.d(t,"j",(function(){return S})),a.d(t,"f",(function(){return d})),a.d(t,"i",(function(){return R})),a.d(t,"l",(function(){return I})),a.d(t,"d",(function(){return p})),a.d(t,"e",(function(){return O})),a.d(t,"n",(function(){return L})),a.d(t,"o",(function(){return G})),a.d(t,"c",(function(){return M})),a.d(t,"p",(function(){return C})),a.d(t,"q",(function(){return D}));var E=a(112);const n=e=>(t,a,n,l)=>Object(E.d)(e(n,t),e(l,a)),l=e=>t=>{const a=(e=>t=>e.formatMessage({id:t}))(e);return(e,E,n,l)=>{const[i,r]=[t(e,n),t(E,l)].map(a);return i.localeCompare(r)}};var i=a(16),r=a(133),T=a(6),_=a(138),c=a(76);const s={ugw:1,usw:2,uap:3},o=(e,t,a,n)=>{const l=T.DEVICE_STATE_IMPORTANCE[Object(T.getDeviceState)(a)],i=T.DEVICE_STATE_IMPORTANCE[Object(T.getDeviceState)(n)];if(l===i){if(a.adopted===n.adopted){if(a.type!==n.type)return((e,t)=>{const a=e.type,n=t.type;return a===n?Object(E.d)(Object(c.a)(e),Object(c.a)(t)):Object(E.d)(s[a],s[n])})(a,n);const e=a.originalName,t=n.originalName;return e&&t?Object(E.d)(e,t):e?-1:t?1:Object(E.d)(a.modelName,n.modelName)}return Object(E.d)(a.adopted?1:2,n.adopted?1:2)}return Object(E.d)(l,i)},N=(e,t,a,n)=>Object(E.d)(Object(c.a)(a),Object(c.a)(n)),A=(e,t,a,n)=>{const l=Object(_.d)(Object(T.getDeviceIp)(a))||0,i=Object(_.d)(Object(T.getDeviceIp)(n))||0;return Object(E.d)(l,i)},u=(e,t,a,n)=>{const{averageSatisfaction:l}=a.satisfactionByRadio,{averageSatisfaction:i}=n.satisfactionByRadio;let r=Object(T.getDeviceExperience)(a),_=Object(T.getDeviceExperience)(n);return a.type===T.DeviceType.AP&&l<0&&(r=-.5),n.type===T.DeviceType.AP&&i<0&&(_=-.5),Object(E.d)(r,_)},S=(e,t,a,n)=>{const l=Object(T.getDeviceMemoryUsage)(a)||0,i=Object(T.getDeviceMemoryUsage)(n)||0;return Object(E.d)(l,i)},d=(e,t,a,n)=>{const l=parseFloat(Object(i.a)(a,"system-stats.cpu",0)),r=parseFloat(Object(i.a)(n,"system-stats.cpu",0));return Object(E.d)(l,r)},R=(e,t,a,n)=>{const l=parseFloat(Object(i.a)(a,"sys_stats.loadavg_1",-1)),r=parseFloat(Object(i.a)(n,"sys_stats.loadavg_1",-1));return Object(E.d)(l,r)},I=(e,t,a)=>{const n=Object(T.getRadioByType)(e,a),l=Object(T.getRadioByType)(t,a),i=n?Object(T.getRadioStatsByName)(e,n.name):null,r=l?Object(T.getRadioStatsByName)(t,l.name):null;if(n&&l&&i&&r){let a,_;const c=(e,t)=>e&&t?Object(E.d)(e,t):(e?-1:t&&1)||0;return a=("auto"===n.channel?0:n.channel)||0,_=("auto"===l.channel?0:l.channel)||0,c(a,_)?c(a,_):(a=Object(T.getRadioStatsBindedChannel)(e,i)||n.channel||0,_=Object(T.getRadioStatsBindedChannel)(t,r)||l.channel||0,c(a,_)?c(a,_):(a=parseInt(Object(T.getRadioHt)(n),10),_=parseInt(Object(T.getRadioHt)(l),10),c(a,_)?c(a,_):(a=Object(T.getRadioStatsPrimaryChannel)(i)||n.channel||0,_=Object(T.getRadioStatsPrimaryChannel)(r)||n.channel||0,c(a,_)?c(a,_):(a=Object(T.getRadioStatsTransmitPower)(i),_=Object(T.getRadioStatsTransmitPower)(r),c(a,_)?c(a,_):0))))}if(n&&l){if(i)return 1;if(r)return-1}return n?1:l?-1:0},m=(e,t)=>{if(!e.radio_table_stats)return-1;return Object(T.getRadioStatsByType)(e,t).reduce((e,t)=>e+t.num_sta||0,0)},p=(e,t,a,n)=>{const l=m(a,r.b.NG),i=m(n,r.b.NG);return Object(E.d)(l,i)},O=(e,t,a,n)=>{const l=m(a,r.b.NA),i=m(n,r.b.NA);return Object(E.d)(l,i)},b=(e,t)=>{const a=Object(T.getRadioStatsByType)(e,t);return a.length?a.reduce((e,t)=>e+(t.ast_be_xmit||0)+(t.tx_packets||0),0):-1},L=(e,t,a,n)=>{const l=b(a,r.b.NG),i=b(n,r.b.NG);return Object(E.d)(l,i)},G=(e,t,a,n)=>{const l=b(a,r.b.NA),i=b(n,r.b.NA);return Object(E.d)(l,i)},M=(e,t,a,n)=>{const l=Object(T.getChannelValue)(a),i=Object(T.getChannelValue)(n);return Object(E.d)(l,i)},g=(e,t)=>Object(T.getRadioStatsByType)(e,t).reduce((e,t)=>e+t.cu_total||0,0),C=(e,t,a,n)=>{const l=g(a,r.b.NG),i=g(n,r.b.NG);return Object(E.d)(l,i)},D=(e,t,a,n)=>{const l=g(a,r.b.NA),i=g(n,r.b.NA);return Object(E.d)(l,i)}},1952:function(e,t,a){"use strict";var E=a(0),n=a.n(E),l=a(1848),i=a(5),r=a(793),T=a(1939);const _=i.a`
  &-appear,
  &-enter {
    opacity: 0;
    transform: translateX(60px);
  }
  &-appear-active,
  &-enter-active {
    opacity: 1;
    transform: translateX(0);
    transition: opacity 150ms cubic-bezier(0.25, 0.1, 0.25, 1), transform 300ms cubic-bezier(0.25, 0.1, 0.25, 1);
  }
  &-exit {
    opacity: 1;
    transform: translateX(0);
  }
  &-exit-active,
  &-exit-done {
    opacity: 0;
    transform: translateX(60px);
    transition: opacity 100ms cubic-bezier(0.25, 0.1, 0.25, 1), transform 100ms cubic-bezier(0.25, 0.1, 0.25, 1);
  }
`;t.a=({timeout:e={enter:300,exit:100},in:t,ignoredPaths:a,children:i,...c})=>{const s=Object(T.a)(),o=Object(r.a)(a),N=Object(E.useMemo)(()=>n.a.Children.map(i,a=>null===a?a:n.a.createElement(l.a,Object.assign({appear:t||!o||s,in:t||!o||s,timeout:e,classNames:_,mountOnEnter:!0},c),a)),[i,t,o,s,e,c]);return n.a.createElement(n.a.Fragment,null,N)}},1954:function(e,t,a){"use strict";var E=a(0),n=a.n(E),l=a(1848),i=a(5);const r=(e,t)=>i.a`
  &-appear,
  &-enter {
    opacity: 0;
    display: flex !important;
    transform: translateY(-10px);
  }
  &-appear-active,
  &-enter-active {
    display: flex !important;
    ${e&&`flex-direction: ${e};`}
    ${t&&`padding: ${t};`}
    opacity: 1;
    transform: translateY(0px);
    transition: opacity 150ms ease-in-out, transform 300ms cubic-bezier(0.25, 0.1, 0.25, 1);
  }
  &-appear-done,
  &-enter-done {
    display: flex !important;
    ${e&&`flex-direction: ${e};`}
    ${t&&`padding: ${t};`}
    opacity: 1;
  }
  &-exit {
    display: flex !important;
    opacity: 0;
    height: 0;
    box-sizing: border-box;
    margin: 10px 0 0 !important;
    & > * {
      display: none;
    }
  }
  &-exit-active {
    display: flex !important;
    margin: 0 !important;
    transition: margin 300ms cubic-bezier(0.25, 0.1, 0.25, 1);
  }
  &-exit-done {
    display: none;
  }
`;t.a=n.a.memo(({timeout:e=300,in:t=!1,flexDirection:a,padding:i="0 0 32px",wrap:T=!1,children:_,...c})=>{const s=Object(E.useMemo)(()=>n.a.Children.map(_,(E,i)=>n.a.createElement(l.a,Object.assign({appear:t,in:t,timeout:e,classNames:r(a,void 0),mountOnEnter:!0},c),null===E?n.a.createElement("div",null):E)),[_,a,t,c,e]);return T?n.a.createElement(l.a,Object.assign({appear:t,in:t,timeout:e,classNames:r(a,i),mountOnEnter:!0},c),n.a.createElement("div",null,_)):n.a.createElement(n.a.Fragment,null,s)})},2008:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"e",(function(){return T})),a.d(t,"a",(function(){return _}));var E=function(e){return e.toString().substring(1).split(/\/([^/]*)$/)},n=function(e,t){var a=E(e),n=a[0],l=a[1];return new RegExp(t.call(t,n),l)},l=function(e){return n(e,(function(e){var t="^"===e.substring(0,1),a="$"===e.substring(e.length-1);if(!t&&!a)throw new Error("Unable to modify - regex does not contain modifiers to remove");return e.substring(t?1:0,e.length-(a?1:0))}))},i=function(e){return E(e)[0]},r=function(e){return n(e,(function(e){if("^"===e.substring(0,1)||"$"===e.substring(e.length-1))throw new Error("Unable to modify - regex already contains one or more modifiers");return"^".concat(e,"$")}))},T=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("Unable to combine - missing source regexes");var a=e.map((function(e){return"(".concat(E(e)[0],")")})).join("|");return new RegExp(a,t)},_=function(e,t,a,n){return new RegExp((e||"")+E(t)[0]+(a||""),n)}},2020:function(e,t,a){"use strict";var E,n,l;a.d(t,"c",(function(){return E})),a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return l})),function(e){e.ONE="1",e.TWO="2",e.THREE="3",e.FOUR="4",e.FIVE="5"}(E||(E={})),function(e){e.ADVANCED_PROTOCOL="advancedProtocol",e.HACKING="hacking",e.NETWORK_PROTOCOL="networkProtocol",e.OTHER="other",e.P2P="p2p",e.REPUTATION="reputation",e.TRAFFIC="traffic",e.VIRUS="virus"}(n||(n={})),function(e){e.ALERTS="alerts",e.ALLOWLIST="allowlist"}(l||(l={}))},2039:function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var E=a(44),n=a(168),l=a(2008),i=a(98),r=Object(l.e)([i.j,i.m]),T=Object(E.a)((function(e){if("string"!=typeof e)return!1;if(!e.match(r))return!1;var t=new n.Address4(e);if(t.isValid())return t.correctForm()===t.startAddress().address;var a=new n.Address6(e);if(a.isValid()){var E=a.correctForm();return new n.Address6(E).startAddress().address===a.startAddress().address}return!1}))},2056:function(e,t,a){"use strict";a.d(t,"a",(function(){return E})),a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return i})),a.d(t,"e",(function(){return T})),a.d(t,"g",(function(){return _})),a.d(t,"f",(function(){return c})),a.d(t,"h",(function(){return N}));var E=[{defaultValue:!0,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_CONNTRACK_MODULES_FTP",property:"ftp_module"},{defaultValue:!0,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_CONNTRACK_MODULES_H323",property:"h323_module"},{defaultValue:!1,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_CONNTRACK_MODULES_SIP",property:"sip_module"},{defaultValue:!0,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_CONNTRACK_MODULES_GRE",property:"gre_module"},{defaultValue:!0,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_CONNTRACK_MODULES_PPTP",property:"pptp_module"},{defaultValue:!0,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_CONNTRACK_MODULES_TFTP",property:"tftp_module"}];var n=[{defaultValue:!1,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_DEFAULT_ACTION_LOGGING_WAN_RULES",property:"firewall_wan_default_log"},{defaultValue:!1,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_DEFAULT_ACTION_LOGGING_LAN_RULES",property:"firewall_lan_default_log"},{defaultValue:!1,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_DEFAULT_ACTION_LOGGING_GUEST_RULES",property:"firewall_guest_default_log"}];var l=[{defaultValue:!1,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_FIREWALL_OPTIONS_BROADCAST_PING",property:"broadcast_ping"},{defaultValue:!1,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_FIREWALL_OPTIONS_RECEIVE_REDIRECTS",property:"receive_redirects"},{defaultValue:!0,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_FIREWALL_OPTIONS_SEND_REDIRECTS",property:"send_redirects"},{defaultValue:!0,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_FIREWALL_OPTIONS_SYN_COOKIES",property:"syn_cookies"}];var i=[{defaultValue:30,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_FIREWALL_STATE_TIMEOUTS_ICMP",property:"icmp_timeout"},{defaultValue:600,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_FIREWALL_STATE_TIMEOUTS_OTHER",property:"other_timeout"},{defaultValue:10,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_FIREWALL_STATE_TIMEOUTS_TCP_CLOSE",property:"tcp_close_timeout"},{defaultValue:60,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_FIREWALL_STATE_TIMEOUTS_TCP_CLOSE_WAIT",property:"tcp_close_wait_timeout"},{defaultValue:7440,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_FIREWALL_STATE_TIMEOUTS_TCP_ESTABLISHED",property:"tcp_established_timeout"},{defaultValue:120,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_FIREWALL_STATE_TIMEOUTS_TCP_FIN_WAIT",property:"tcp_fin_wait_timeout"},{defaultValue:30,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_FIREWALL_STATE_TIMEOUTS_TCP_LAST_ACK",property:"tcp_last_ack_timeout"},{defaultValue:60,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_FIREWALL_STATE_TIMEOUTS_TCP_SYN_RECV",property:"tcp_syn_recv_timeout"},{defaultValue:120,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_FIREWALL_STATE_TIMEOUTS_TCP_SYN_SENT",property:"tcp_syn_sent_timeout"},{defaultValue:120,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_FIREWALL_STATE_TIMEOUTS_TCP_TIME_WAIT",property:"tcp_time_wait_timeout"},{defaultValue:30,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_FIREWALL_STATE_TIMEOUTS_UDP_OTHER",property:"udp_other_timeout"},{defaultValue:180,label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_SETTINGS_FIREWALL_STATE_TIMEOUTS_UDP_STREAM",property:"udp_stream_timeout"}],r=a(2020);const T=[{doesAccountToLimited:!1,group:r.b.TRAFFIC,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_ACTIVEX",description:"IPS_VALUES_CATEGORY_EMERGING_ACTIVEX_DESC",sensitivity:r.c.FIVE,value:"emerging-activex"},{doesAccountToLimited:!1,group:r.b.HACKING,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_ATTACKRESPONSE",description:"IPS_VALUES_CATEGORY_EMERGING_ATTACKRESPONSE_DESC",sensitivity:r.c.THREE,value:"emerging-attackresponse"},{doesAccountToLimited:!0,group:r.b.VIRUS,isDefault:!1,label:"IPS_VALUES_CATEGORY_BOTCC",description:"IPS_VALUES_CATEGORY_BOTCC_DESC",sensitivity:r.c.THREE,value:"botcc"},{doesAccountToLimited:!1,group:r.b.TRAFFIC,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_CHAT",sensitivity:r.c.FIVE,value:"emerging-chat"},{doesAccountToLimited:!1,group:r.b.REPUTATION,isDefault:!1,label:"IPS_VALUES_CATEGORY_CIARMY",description:"IPS_VALUES_CATEGORY_CIARMY_DESC",sensitivity:r.c.TWO,value:"ciarmy"},{doesAccountToLimited:!1,group:r.b.REPUTATION,isDefault:!1,label:"IPS_VALUES_CATEGORY_COMPROMISED",description:"IPS_VALUES_CATEGORY_COMPROMISED_DESC",sensitivity:r.c.TWO,value:"compromised"},{doesAccountToLimited:!0,group:r.b.TRAFFIC,isDefault:!0,label:"IPS_VALUES_CATEGORY_EMERGING_DNS",description:"IPS_VALUES_CATEGORY_EMERGING_DNS_DESC",sensitivity:r.c.FIVE,value:"emerging-dns"},{doesAccountToLimited:!1,group:r.b.HACKING,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_DOS",description:"IPS_VALUES_CATEGORY_EMERGING_DOS_DESC",sensitivity:r.c.FIVE,value:"emerging-dos"},{doesAccountToLimited:!0,group:r.b.REPUTATION,isDefault:!1,label:"IPS_VALUES_CATEGORY_DSHIELD",description:"IPS_VALUES_CATEGORY_DSHIELD_DESC",sensitivity:r.c.TWO,value:"dshield"},{doesAccountToLimited:!0,group:r.b.HACKING,isDefault:!0,label:"IPS_VALUES_CATEGORY_EMERGING_EXPLOIT",description:"IPS_VALUES_CATEGORY_EMERGING_EXPLOIT_DESC",sensitivity:r.c.ONE,value:"emerging-exploit"},{doesAccountToLimited:!1,group:r.b.NETWORK_PROTOCOL,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_FTP",description:"IPS_VALUES_CATEGORY_EMERGING_FTP_DESC",sensitivity:r.c.FIVE,value:"emerging-ftp"},{doesAccountToLimited:!1,group:r.b.TRAFFIC,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_GAMES",description:"IPS_VALUES_CATEGORY_EMERGING_GAMES_DESC",sensitivity:r.c.FIVE,value:"emerging-games"},{doesAccountToLimited:!1,group:r.b.NETWORK_PROTOCOL,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_ICMP",description:"IPS_VALUES_CATEGORY_EMERGING_ICMP_DESC",sensitivity:r.c.FIVE,value:"emerging-icmp"},{doesAccountToLimited:!1,group:r.b.NETWORK_PROTOCOL,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_ICMPINFO",sensitivity:r.c.FIVE,value:"emerging-icmpinfo"},{doesAccountToLimited:!1,group:r.b.NETWORK_PROTOCOL,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_IMAP",description:"IPS_VALUES_CATEGORY_EMERGING_IMAP_DESC",sensitivity:r.c.FIVE,value:"emerging-imap"},{doesAccountToLimited:!1,group:r.b.TRAFFIC,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_INAPPROPRIATE",sensitivity:r.c.FIVE,value:"emerging-inappropriate"},{doesAccountToLimited:!1,group:r.b.OTHER,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_INFO",sensitivity:r.c.TWO,value:"emerging-info"},{doesAccountToLimited:!0,group:r.b.VIRUS,isDefault:!0,label:"IPS_VALUES_CATEGORY_EMERGING_MALWARE",description:"IPS_VALUES_CATEGORY_EMERGING_MALWARE_DESC",sensitivity:r.c.ONE,value:"emerging-malware"},{doesAccountToLimited:!1,group:r.b.OTHER,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_MISC",description:"IPS_VALUES_CATEGORY_EMERGING_MISC_DESC",sensitivity:r.c.FIVE,value:"emerging-misc"},{doesAccountToLimited:!0,group:r.b.VIRUS,isDefault:!0,label:"IPS_VALUES_CATEGORY_EMERGING_MOBILE",description:"IPS_VALUES_CATEGORY_EMERGING_MOBILE_DESC",sensitivity:r.c.ONE,value:"emerging-mobile"},{doesAccountToLimited:!1,group:r.b.NETWORK_PROTOCOL,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_NETBIOS",description:"IPS_VALUES_CATEGORY_EMERGING_NETBIOS_DESC",sensitivity:r.c.THREE,value:"emerging-netbios"},{doesAccountToLimited:!0,group:r.b.P2P,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_P2P",description:"IPS_VALUES_CATEGORY_EMERGING_P2P_DESC",sensitivity:r.c.FIVE,value:"emerging-p2p"},{doesAccountToLimited:!1,group:r.b.OTHER,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_POLICY",sensitivity:r.c.FIVE,value:"emerging-policy"},{doesAccountToLimited:!1,group:r.b.NETWORK_PROTOCOL,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_POP3",description:"IPS_VALUES_CATEGORY_EMERGING_POP3_DESC",sensitivity:r.c.FIVE,value:"emerging-pop3"},{doesAccountToLimited:!1,group:r.b.HACKING,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_RPC",description:"IPS_VALUES_CATEGORY_EMERGING_RPC_DESC",sensitivity:r.c.THREE,value:"emerging-rpc"},{doesAccountToLimited:!1,group:r.b.ADVANCED_PROTOCOL,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_SCADA",sensitivity:r.c.THREE,value:"emerging-scada"},{doesAccountToLimited:!1,group:r.b.HACKING,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_SCAN",description:"IPS_VALUES_CATEGORY_EMERGING_SCAN_DESC",sensitivity:r.c.THREE,value:"emerging-scan"},{doesAccountToLimited:!0,group:r.b.HACKING,isDefault:!0,label:"IPS_VALUES_CATEGORY_EMERGING_SHELLCODE",description:"IPS_VALUES_CATEGORY_EMERGING_SHELLCODE_DESC",sensitivity:r.c.ONE,value:"emerging-shellcode"},{doesAccountToLimited:!1,group:r.b.NETWORK_PROTOCOL,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_SMTP",description:"IPS_VALUES_CATEGORY_EMERGING_SMTP_DESC",sensitivity:r.c.FOUR,value:"emerging-smtp"},{doesAccountToLimited:!1,group:r.b.ADVANCED_PROTOCOL,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_SNMP",description:"IPS_VALUES_CATEGORY_EMERGING_SNMP_DESC",sensitivity:r.c.FOUR,value:"emerging-snmp"},{doesAccountToLimited:!1,group:r.b.TRAFFIC,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_SQL",description:"IPS_VALUES_CATEGORY_EMERGING_SQL_DESC",sensitivity:r.c.FOUR,value:"emerging-sql"},{doesAccountToLimited:!1,group:r.b.NETWORK_PROTOCOL,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_TELNET",description:"IPS_VALUES_CATEGORY_EMERGING_TELNET_DESC",sensitivity:r.c.THREE,value:"emerging-telnet"},{doesAccountToLimited:!1,group:r.b.NETWORK_PROTOCOL,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_TFTP",description:"IPS_VALUES_CATEGORY_EMERGING_TFTP_DESC",sensitivity:r.c.FIVE,value:"emerging-tftp"},{doesAccountToLimited:!0,group:r.b.P2P,isDefault:!0,label:"IPS_VALUES_CATEGORY_TOR",description:"IPS_VALUES_CATEGORY_TOR_DESC",sensitivity:r.c.TWO,value:"tor"},{doesAccountToLimited:!1,group:r.b.VIRUS,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_TROJAN",description:"IPS_VALUES_CATEGORY_EMERGING_TROJAN_DESC",sensitivity:r.c.ONE,value:"emerging-trojan"},{doesAccountToLimited:!0,group:r.b.TRAFFIC,isDefault:!0,label:"IPS_VALUES_CATEGORY_EMERGING_USERAGENT",description:"IPS_VALUES_CATEGORY_EMERGING_USERAGENT_DESC",sensitivity:r.c.FOUR,value:"emerging-useragent"},{doesAccountToLimited:!1,group:r.b.ADVANCED_PROTOCOL,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_VOIP",description:"IPS_VALUES_CATEGORY_EMERGING_VOIP_DESC",sensitivity:r.c.FIVE,value:"emerging-voip"},{doesAccountToLimited:!1,group:r.b.TRAFFIC,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_WEBAPPS",description:"IPS_VALUES_CATEGORY_EMERGING_WEBAPPS_DESC",sensitivity:r.c.FOUR,value:"emerging-webapps"},{doesAccountToLimited:!1,group:r.b.TRAFFIC,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_WEBCLIENT",description:"IPS_VALUES_CATEGORY_EMERGING_WEBCLIENT_DESC",sensitivity:r.c.FOUR,value:"emerging-webclient"},{doesAccountToLimited:!1,group:r.b.TRAFFIC,isDefault:!1,label:"IPS_VALUES_CATEGORY_EMERGING_WEBSERVER",description:"IPS_VALUES_CATEGORY_EMERGING_WEBSERVER_DESC",sensitivity:r.c.TWO,value:"emerging-webserver"},{doesAccountToLimited:!0,group:r.b.VIRUS,isDefault:!0,label:"IPS_VALUES_CATEGORY_EMERGING_WORM",description:"IPS_VALUES_CATEGORY_EMERGING_WORM_DESC",sensitivity:r.c.ONE,value:"emerging-worm"}],_=T.filter(({value:e})=>!["emerging-chat","emerging-icmpinfo","emerging-inappropriate","emerging-info","emerging-policy","emerging-scada"].includes(e));var c={[r.b.VIRUS]:{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_CATEGORY_GROUP_VIRUS"},[r.b.P2P]:{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_CATEGORY_GROUP_P2P"},[r.b.HACKING]:{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_CATEGORY_GROUP_HACKING"},[r.b.TRAFFIC]:{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_CATEGORY_GROUP_TRAFFIC"},[r.b.REPUTATION]:{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_CATEGORY_GROUP_REPUTATION"},[r.b.NETWORK_PROTOCOL]:{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_CATEGORY_GROUP_NETWORK_PROTOCOL"},[r.b.ADVANCED_PROTOCOL]:{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_CATEGORY_GROUP_ADVANCED_PROTOCOL"},[r.b.OTHER]:{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_IPS_CATEGORY_GROUP_OTHER"}},s=a(30);const o=i.reduce((e,{label:t,property:a})=>(e[a]=s.a.number().label(t).max(21474836).min(1).required(),e),{});var N=s.a.object().shape({usg:s.a.object().shape({...o})})},2094:function(e,t,a){"use strict";var E=a(5),n=a(52);t.a=Object(E.c)(n.a)`
  width: 385px;
  ${({theme:e})=>`padding: ${e.spacing["spacing-xxl"]} ${e.spacing["spacing-xxxxxl"]} ${e.spacing["spacing-xxxxl"]} `};

  header {
    > div {
      margin-bottom: ${({theme:e})=>e.spacing["spacing-xxxxl"]};
    }
  }
  footer {
    border-top: 1px solid ${({theme:e})=>e.motifPalette.ui07};
    margin-top: ${({theme:e})=>e.spacing["spacing-xxxxl"]};
    button {
      padding: 0 ${({theme:e})=>e.spacing["spacing-xxxxl"]};
    }
  }
`},2158:function(e,t,a){"use strict";a.d(t,"e",(function(){return T})),a.d(t,"a",(function(){return _})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"f",(function(){return N})),a.d(t,"g",(function(){return A}));var E=a(0),n=a.n(E),l=a(4),i=a(392),r=a(268);const T=e=>"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_PROTOCOL_"+e.replace(/[.-]/g,"_").toUpperCase(),_=e=>{const t=void 0!==e.protocol&&null!==e.protocol?e.protocol:e.protocol_v6,a=!Number.isNaN(Number(t));return e.protocol_match_excepted?n.a.createElement(l.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TABLE_PROTOCOL_MATCH_EXCEPTED",values:{protocol:a?t:n.a.createElement(l.c,{id:T(t)})}}):a?String(t):n.a.createElement(l.c,{id:T(t)})},c=e=>{switch(e){case i.FirewallGroupType.ADDRESS_GROUP:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TYPE_ADDRESS_GROUP";case i.FirewallGroupType.IPV6_ADDRESS_GROUP:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TYPE_IPV6_ADDRESS_GROUP";case i.FirewallGroupType.PORT_GROUP:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TYPE_PORT_GROUP";default:return"COMMON_UNKNOWN"}},s=e=>{switch(e){case r.FirewallRuleAction.ACCEPT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_ACTION_ACCEPT";case r.FirewallRuleAction.DROP:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_ACTION_DROP";case r.FirewallRuleAction.REJECT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_ACTION_REJECT";default:return"COMMON_UNKNOWN"}},o=e=>"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_ICMP_TYPENAME_"+(e||"none").replace(/-/g,"_").toUpperCase(),N=e=>{switch(e){case r.FirewallRuleRulesetV4.GUEST_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUEST_IN";case r.FirewallRuleRulesetV4.GUEST_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUEST_LOCAL";case r.FirewallRuleRulesetV4.GUEST_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUEST_OUT";case r.FirewallRuleRulesetV4.LAN_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LAN_IN";case r.FirewallRuleRulesetV4.LAN_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LAN_LOCAL";case r.FirewallRuleRulesetV4.LAN_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LAN_OUT";case r.FirewallRuleRulesetV4.WAN_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WAN_IN";case r.FirewallRuleRulesetV4.WAN_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WAN_LOCAL";case r.FirewallRuleRulesetV4.WAN_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WAN_OUT";case r.FirewallRuleRulesetV6.GUESTV6_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUESTV6_IN";case r.FirewallRuleRulesetV6.GUESTV6_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUESTV6_LOCAL";case r.FirewallRuleRulesetV6.GUESTV6_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUESTV6_OUT";case r.FirewallRuleRulesetV6.LANV6_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LANV6_IN";case r.FirewallRuleRulesetV6.LANV6_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LANV6_LOCAL";case r.FirewallRuleRulesetV6.LANV6_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LANV6_OUT";case r.FirewallRuleRulesetV6.WANV6_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WANV6_IN";case r.FirewallRuleRulesetV6.WANV6_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WANV6_LOCAL";case r.FirewallRuleRulesetV6.WANV6_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WANV6_OUT";default:return"COMMON_UNKNOWN"}},A=e=>{let t=Math.min(...e.map(({rule_index:e})=>Number(e)));return e.map(e=>({...e,rule_index:(t++).toString()}))}}}]);